<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Introduction to Data Mining</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DMwR 2nd Edition</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-indent"></span>
     
    Contents
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Part I - R and Data Mining</li>
    <li>
      <a href="introR.html">Introduction to R</a>
    </li>
    <li>
      <a href="introDM.html">Introduction to Data Mining</a>
    </li>
    <li class="dropdown-header">Part II - Case Studies</li>
    <li>
      <a href="algae.html">Predicting Algae Blooms</a>
    </li>
    <li>
      <a href="stocks.html">Predicting Stock Market Returns</a>
    </li>
    <li>
      <a href="fraud.html">Detecting Fraudulent Transactions</a>
    </li>
    <li>
      <a href="bio.html">Classifying Micro Array Samples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-code"></span>
     
    R Code
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Part I - R and Data Mining</li>
    <li>
      <a href="RintroR.html">Introduction to R</a>
    </li>
    <li>
      <a href="RintroDM.html">Introduction to Data Mining</a>
    </li>
    <li class="dropdown-header">Part II - Case Studies</li>
    <li>
      <a href="Ralgae.html">Predicting Algae Blooms</a>
    </li>
    <li>
      <a href="Rstocks.html">Predicting Stock Market Returns</a>
    </li>
    <li>
      <a href="Rfraud.html">Detecting Fraudulent Transactions</a>
    </li>
    <li>
      <a href="Rbio.html">Classifying Micro Array Samples</a>
    </li>
  </ul>
</li>
<li>
  <a href="datasets.html">
    <span class="fa fa-database"></span>
     
    Datasets
  </a>
</li>
<li>
  <a href="Errata.html">
    <span class="fa fa-exclamation-triangle"></span>
     
    Errata
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="News.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info-circle"></span>
     
    Contact
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to Data Mining</h1>

</div>


<p>The following is a <a href="RCode/RintroDM.R">script file</a> containing all R code of all sections in this chapter.</p>
<!-- DCandBU.Rnw -->
<div id="data-collection-and-business-understanding" class="section level3">
<h3>Data Collection and Business Understanding</h3>
<div id="data-and-datasets" class="section level4">
<h4>Data and Datasets</h4>
</div>
<div id="importing-data-into-r" class="section level4">
<h4>Importing Data into R</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;x.csv&quot;</span>)
dat
<span class="kw">class</span>(dat)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;z.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>, <span class="dt">na=</span><span class="st">&quot;???&quot;</span>)
d</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DBI)
## The DBMS-specific code starts here
<span class="kw">library</span>(RMySQL)
drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span>
con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  <span class="co"># connecting to the DBMS</span>
                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypasswd&quot;</span>,
                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)
## The DBMS-specific code ends here

## getting the results of an SQL query as a data frame
data &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT * FROM clients&quot;</span>) 

## closing up stuff
<span class="kw">dbDisconnect</span>(con)  
<span class="kw">dbUnloadDriver</span>(drv)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DBI)
<span class="kw">library</span>(RMySQL)
drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span>
con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  <span class="co"># connecting to the DBMS</span>
                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypasswd&quot;</span>,
                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)

res  &lt;-<span class="st"> </span><span class="kw">dbSendQuery</span>(con,<span class="st">&quot;SELECT * FROM transactions&quot;</span>) 
while (!<span class="kw">dbHasCompleted</span>(res)) {
    <span class="co"># get the next 50 records on a data frame</span>
    someData &lt;-<span class="st"> </span><span class="kw">fetch</span>(res, <span class="dt">n =</span> <span class="dv">50</span>)  
    <span class="co"># call some function that handles the current chunk</span>
    <span class="kw">myProcessingFunction</span>(someData)  
}
<span class="kw">dbClearResult</span>(res) <span class="co"># clear the results set</span>

<span class="kw">dbDisconnect</span>(con)  <span class="co"># closing up stuff</span>
<span class="kw">dbUnloadDriver</span>(drv)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMySQL)
<span class="kw">library</span>(dplyr)
dbConn &lt;-<span class="st"> </span><span class="kw">src_mysql</span>(<span class="st">&quot;sonae&quot;</span>,
                    <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>,<span class="dt">user=</span><span class="st">&quot;prodUser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;myPassword&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sensors &lt;-<span class="st"> </span><span class="kw">tbl</span>(dbConn,<span class="st">&quot;sensor_values&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sensors %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(sid==<span class="dv">274</span>,value &gt;<span class="st"> </span><span class="dv">100</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(time,value)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;clipboard&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)
fc &lt;-<span class="st"> &quot;c:</span><span class="ch">\\</span><span class="st">Documents and Settings</span><span class="ch">\\</span><span class="st">xpto</span><span class="ch">\\</span><span class="st">My Documents</span><span class="ch">\\</span><span class="st">calc.xls&quot;</span>
dat &lt;-<span class="st"> </span><span class="kw">read_excel</span>(fc,<span class="dt">sheet=</span><span class="dv">1</span>)</code></pre></div>
<!-- dataPP.Rnw -->
</div>
</div>
<div id="data-pre-processing" class="section level3">
<h3>Data Pre-Processing</h3>
<div id="data-cleaning" class="section level4">
<h4>Data Cleaning</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
std &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;stud.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>, 
                  <span class="dt">skip=</span><span class="dv">1</span>, <span class="dt">col_names=</span><span class="kw">c</span>(<span class="st">&quot;StudentName&quot;</span>,<span class="st">&quot;Math&quot;</span>,<span class="st">&quot;English&quot;</span>))
std</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)
stdL &lt;-<span class="st"> </span><span class="kw">gather</span>(std, Subject, Grade, Math:English)
stdL</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spread</span>(stdL, Subject, Grade)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">std2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;stud2.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>,
                   <span class="dt">skip=</span><span class="dv">1</span>, <span class="dt">col_names=</span><span class="kw">c</span>(<span class="st">&quot;StudentName&quot;</span>,<span class="st">&quot;Math&quot;</span>,<span class="st">&quot;English&quot;</span>,<span class="st">&quot;Degree_Year&quot;</span>))
std2
std2L &lt;-<span class="st"> </span><span class="kw">gather</span>(std2, Subject, Grade, Math:English)
std2L &lt;-<span class="st"> </span><span class="kw">separate</span>(std2L, Degree_Year, <span class="kw">c</span>(<span class="st">&quot;Degree&quot;</span>,<span class="st">&quot;Year&quot;</span>))
std2L</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
<span class="kw">ymd</span>(<span class="st">&quot;20151021&quot;</span>)
<span class="kw">ymd</span>(<span class="st">&quot;2015/11/30&quot;</span>)
<span class="kw">myd</span>(<span class="st">&quot;11.2012.3&quot;</span>)
<span class="kw">dmy_hms</span>(<span class="st">&quot;2/12/2013 14:05:01&quot;</span>)
<span class="kw">mdy</span>(<span class="st">&quot;120112&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20120521</span>, <span class="st">&quot;2010-12-12&quot;</span>, <span class="st">&quot;2007/01/5&quot;</span>, <span class="st">&quot;2015-2-04&quot;</span>, 
           <span class="st">&quot;Measured on 2014-12-6&quot;</span>, <span class="st">&quot;2013-7+ 25&quot;</span>)
dates &lt;-<span class="st"> </span><span class="kw">ymd</span>(dates)
dates</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data.frame</span>(<span class="dt">Dates=</span>dates,<span class="dt">WeekDay=</span><span class="kw">wday</span>(dates),<span class="dt">nWeekDay=</span><span class="kw">wday</span>(dates,<span class="dt">label=</span><span class="ot">TRUE</span>),
           <span class="dt">Year=</span><span class="kw">year</span>(dates),<span class="dt">Month=</span><span class="kw">month</span>(dates,<span class="dt">label=</span><span class="ot">TRUE</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">date &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;20150823 18:00:05&quot;</span>,<span class="dt">tz=</span><span class="st">&quot;Europe/Berlin&quot;</span>)
date</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with_tz</span>(date,<span class="dt">tz=</span><span class="st">&quot;Pacific/Auckland&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">force_tz</span>(date,<span class="dt">tz=</span><span class="st">&quot;Pacific/Auckland&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(readr)
uci.repo &lt;-<span class="st"> &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/&quot;</span>
dataset &lt;-<span class="st"> &quot;audiology/audiology.standardized&quot;</span>
dataF &lt;-<span class="st"> </span><span class="kw">str_c</span>(uci.repo,dataset,<span class="st">&quot;.data&quot;</span>)
namesF &lt;-<span class="st"> </span><span class="kw">str_c</span>(uci.repo,dataset,<span class="st">&quot;.names&quot;</span>)
## Reading the data file
data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">url</span>(dataF), <span class="dt">col_names=</span><span class="ot">FALSE</span>, <span class="dt">na=</span><span class="st">&quot;?&quot;</span>)
data
<span class="kw">dim</span>(data)
## Now reading the names file
text &lt;-<span class="st"> </span><span class="kw">read_lines</span>(<span class="kw">url</span>(namesF))
text[<span class="dv">1</span>:<span class="dv">3</span>]
<span class="kw">length</span>(text)
text[<span class="dv">67</span>:<span class="dv">70</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nms &lt;-<span class="st"> </span><span class="kw">str_split_fixed</span>(text[<span class="dv">67</span>:<span class="dv">135</span>],<span class="st">&quot;:&quot;</span>,<span class="dt">n=</span><span class="dv">2</span>)[,<span class="dv">1</span>] <span class="co"># get the names</span>
nms[<span class="dv">1</span>:<span class="dv">3</span>]
nms &lt;-<span class="st"> </span><span class="kw">str_trim</span>(nms) <span class="co"># trim white space</span>
nms[<span class="dv">1</span>:<span class="dv">3</span>]
nms &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(nms,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(|</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="co"># delete invalid chars.</span>
nms[<span class="dv">1</span>:<span class="dv">3</span>]
<span class="kw">colnames</span>(data)[<span class="dv">1</span>:<span class="dv">69</span>] &lt;-<span class="st"> </span>nms
data[<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">10</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat
<span class="kw">class</span>(dat$Y)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
dat$Y &lt;-<span class="st"> </span><span class="kw">parse_integer</span>(dat$Y, <span class="dt">na=</span><span class="st">&quot;?&quot;</span>)
dat
<span class="kw">class</span>(dat$Y)</code></pre></div>
</div>
<div id="transforming-variables" class="section level4">
<h4>Transforming Variables</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">data</span>(iris)
iris.stand &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">scale</span>(<span class="kw">select</span>(iris,-Species)),<span class="kw">select</span>(iris,Species))
<span class="kw">summary</span>(iris.stand)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mxs &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">select</span>(iris,-Species), <span class="dv">2</span>, max, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
mns &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">select</span>(iris,-Species), <span class="dv">2</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
iris.norm &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">scale</span>(<span class="kw">select</span>(iris,-Species), <span class="dt">center=</span>mns, <span class="dt">scale=</span>mxs-mns),
                   <span class="kw">select</span>(iris,Species))
<span class="kw">summary</span>(iris.norm)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Hmisc) <span class="co"># for cut2()</span>
<span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>) <span class="co"># loading the data</span>
<span class="kw">summary</span>(Boston$age) <span class="co"># the numeric variable we are going to discretize</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Boston$newAge &lt;-<span class="st"> </span><span class="kw">cut</span>(Boston$age,<span class="dv">5</span>)
<span class="kw">table</span>(Boston$newAge)
Boston$newAge &lt;-<span class="st"> </span><span class="kw">cut</span>(Boston$age,<span class="dv">5</span>, <span class="co"># alternative using our own labels for the bins</span>
                     <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;verynew&quot;</span>,<span class="st">&quot;new&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;old&quot;</span>,<span class="st">&quot;veryold&quot;</span>))
<span class="kw">table</span>(Boston$newAge)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Boston$newAge &lt;-<span class="st"> </span><span class="kw">cut2</span>(Boston$age, <span class="dt">g=</span><span class="dv">5</span>)
<span class="kw">table</span>(Boston$newAge)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Boston$newAge &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">cut2</span>(Boston$age, <span class="dt">g=</span><span class="dv">5</span>),
                        <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;verynew&quot;</span>,<span class="st">&quot;new&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;old&quot;</span>,<span class="st">&quot;veryold&quot;</span>))
<span class="kw">table</span>(Boston$newAge)</code></pre></div>
</div>
<div id="creating-variables" class="section level4">
<h4>Creating Variables</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
<span class="kw">library</span>(xts)
sp500 &lt;-<span class="st"> </span><span class="kw">xts</span>(<span class="kw">c</span>(<span class="fl">1102.94</span>,<span class="fl">1104.49</span>,<span class="fl">1115.71</span>,<span class="fl">1118.31</span>),
             <span class="kw">ymd</span>(<span class="kw">c</span>(<span class="st">&quot;2010-02-25&quot;</span>,<span class="st">&quot;2010-02-26&quot;</span>,<span class="st">&quot;2010-03-01&quot;</span>,<span class="st">&quot;2010-03-02&quot;</span>),
                 <span class="dt">tz=</span><span class="kw">Sys.getenv</span>(<span class="st">&quot;TZ&quot;</span>))
             )
sp500</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp500[<span class="st">&quot;2010-03-02&quot;</span>]
sp500[<span class="st">&quot;2010-03&quot;</span>]
sp500[<span class="st">&quot;2010-03-01/&quot;</span>]
sp500[<span class="st">&quot;2010-02-26/2010-03-01&quot;</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(xts)
<span class="kw">data</span>(AirPassengers)
ap &lt;-<span class="st"> </span><span class="kw">as.xts</span>(AirPassengers)
apRel &lt;-<span class="st"> </span><span class="kw">diff</span>(ap)/ap[-<span class="kw">length</span>(ap)]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(ap)
<span class="kw">head</span>(<span class="kw">embed</span>(ap,<span class="dv">4</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">createEmbedDS &lt;-<span class="st"> </span>function(s, <span class="dt">emb=</span><span class="dv">4</span>) {
    d &lt;-<span class="st"> </span><span class="kw">dim</span>(s)
    if (!<span class="kw">is.null</span>(d) &amp;&amp;<span class="st"> </span>d[<span class="dv">2</span>] &gt;<span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;Only applicable to uni-variate time series&quot;</span>)
    if (emb &lt;<span class="st"> </span><span class="dv">2</span> ||<span class="st"> </span>emb &gt;<span class="st"> </span><span class="kw">length</span>(s)) <span class="kw">stop</span>(<span class="st">&quot;Invalid embed size&quot;</span>)
    e &lt;-<span class="st"> </span><span class="kw">embed</span>(s,emb)
    <span class="kw">colnames</span>(e) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>,<span class="kw">paste</span>(<span class="st">&quot;T&quot;</span>,<span class="dv">1</span>:(emb<span class="dv">-1</span>),<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))
    if (<span class="kw">is.xts</span>(s)) <span class="kw">return</span>(<span class="kw">xts</span>(e,<span class="kw">index</span>(s)[emb:<span class="kw">length</span>(s)])) else <span class="kw">return</span>(e)
}
dataSet &lt;-<span class="st"> </span><span class="kw">createEmbedDS</span>(ap,<span class="dt">emb=</span><span class="dv">5</span>)
<span class="kw">head</span>(dataSet)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
ff &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;forestFires.txt&quot;</span>)
ff</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sp)
<span class="kw">library</span>(dplyr)
spatialCoords &lt;-<span class="st"> </span><span class="kw">select</span>(ff,<span class="dt">long=</span>x,<span class="dt">lat=</span>y) <span class="co"># the contextual data</span>
firesData &lt;-<span class="st"> </span><span class="kw">select</span>(ff,ano2000) <span class="co"># the behavioral data</span>
coordRefSys &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +ellps=WGS84&quot;</span>)
fires2000 &lt;-<span class="st"> </span><span class="kw">SpatialPointsDataFrame</span>(spatialCoords,
                                    firesData,
                                    <span class="dt">proj4string=</span>coordRefSys)
fires2000[<span class="dv">1</span>:<span class="dv">3</span>,]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bbox</span>(fires2000)
<span class="kw">coordinates</span>(fires2000)[<span class="dv">1</span>:<span class="dv">3</span>,]
<span class="kw">summary</span>(fires2000)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)
<span class="kw">library</span>(tibble)
mapPT &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Portugal&quot;</span>,<span class="dt">zoom=</span><span class="dv">7</span>)
d4plot &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">cbind</span>(<span class="kw">coordinates</span>(fires2000),<span class="dt">burnt=</span>fires2000$ano2000))
<span class="kw">ggmap</span>(mapPT) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span><span class="kw">filter</span>(d4plot, burnt==<span class="dv">1</span>),<span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat),<span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tm)
docs &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">DirSource</span>(<span class="st">&quot;Documents&quot;</span>))
docs</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docs[[<span class="dv">2</span>]]
<span class="kw">content</span>(docs[[<span class="dv">2</span>]])[<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docs &lt;-<span class="st"> </span>docs %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(removePunctuation) %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(<span class="kw">content_transformer</span>(tolower)) %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(removeNumbers) %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(removeWords, <span class="kw">stopwords</span>(<span class="st">&quot;en&quot;</span>)) %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(stripWhitespace) %&gt;%
<span class="st">        </span><span class="kw">tm_map</span>(stemDocument)
<span class="kw">content</span>(docs[[<span class="dv">2</span>]])[<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">weighting=</span>weightTfIdf))
data
<span class="kw">inspect</span>(data[<span class="dv">1</span>:<span class="dv">2</span>,<span class="dv">1</span>:<span class="dv">5</span>])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">findFreqTerms</span>(data,<span class="fl">0.9</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">findAssocs</span>(data,<span class="st">&quot;race&quot;</span>,<span class="fl">0.5</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newData &lt;-<span class="st"> </span><span class="kw">removeSparseTerms</span>(data,<span class="fl">0.7</span>)
newData</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)
<span class="kw">as_tibble</span>(<span class="kw">as.matrix</span>(newData))</code></pre></div>
</div>
<div id="dimensionality-reduction" class="section level4">
<h4>Dimensionality Reduction</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
prop2sample &lt;-<span class="st"> </span><span class="fl">0.5</span>
rowIDs &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="kw">as.integer</span>(prop2sample*<span class="kw">nrow</span>(iris)))
iris.sample &lt;-<span class="st"> </span>iris[rowIDs,]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
prop2sample &lt;-<span class="st"> </span><span class="fl">0.5</span>
rowIDs &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="kw">as.integer</span>(prop2sample*<span class="kw">nrow</span>(iris)), <span class="dt">replace=</span><span class="ot">TRUE</span>)
iris.sample &lt;-<span class="st"> </span>iris[rowIDs,]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nrLinesFile &lt;-<span class="st"> </span>function(f) {
    if (.Platform$OS.type ==<span class="st"> &quot;unix&quot;</span>) 
        <span class="kw">as.integer</span>(<span class="kw">strsplit</span>(<span class="kw">trimws</span>(<span class="kw">system</span>(<span class="kw">paste</span>(<span class="st">&quot;wc -l&quot;</span>,f),<span class="dt">intern=</span><span class="ot">TRUE</span>)),
                            <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]) 
    else 
        <span class="kw">stop</span>(<span class="st">&quot;This function requires unix-based systems&quot;</span>)
}

sampleCSV &lt;-<span class="st"> </span>function(file, percORn, nrLines, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">mxPerc=</span><span class="fl">0.5</span>) {
    if (.Platform$OS.type !=<span class="st"> &quot;unix&quot;</span>) 
        <span class="kw">stop</span>(<span class="st">&quot;This function requires unix-based systems&quot;</span>)
    <span class="kw">require</span>(readr, <span class="dt">quietly=</span><span class="ot">TRUE</span>)
    
    if (<span class="kw">missing</span>(nrLines)) nrLines &lt;-<span class="st"> </span><span class="kw">nrLinesFile</span>(file)
    
    if (percORn &lt;<span class="st"> </span><span class="dv">1</span>)
        if (percORn &gt;<span class="st"> </span>mxPerc) 
            <span class="kw">stop</span>(<span class="st">&quot;This function is not adequate for that big samples.&quot;</span>)
        else percORn &lt;-<span class="st"> </span><span class="kw">as.integer</span>(percORn*nrLines)
    perc &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">2</span>*percORn/nrLines, mxPerc)
    
    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;perl -ne &#39;print if (rand() &lt; &quot;</span>,perc,<span class="st">&quot;)&#39; &quot;</span>,file,
                  <span class="st">&quot; &gt; &quot;</span>,file,<span class="st">&quot;.tmp.csv&quot;</span>))
    dt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">paste0</span>(file,<span class="st">&quot;.tmp.csv&quot;</span>),<span class="dt">col_names=</span>header, <span class="dt">n_max=</span>percORn)
    <span class="kw">file.remove</span>(<span class="kw">paste0</span>(file,<span class="st">&quot;.tmp.csv&quot;</span>))
    if (<span class="kw">nrow</span>(dt) !=<span class="st"> </span>percORn) 
        <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&quot;Expecting&quot;</span>,percORn,<span class="st">&quot;rows, but got&quot;</span>,<span class="kw">nrow</span>(dt)))
    dt
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()
d &lt;-<span class="st"> </span><span class="kw">sampleCSV</span>(<span class="st">&quot;allsensors.csv&quot;</span>, <span class="fl">0.01</span>)
<span class="kw">Sys.time</span>()-t
<span class="kw">nrow</span>(d)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DBI)
<span class="kw">library</span>(RMySQL)
drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span>
con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  
                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypassword&quot;</span>,
                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sampleDBMS &lt;-<span class="st"> </span>function(dbConn, tbl, percORn, <span class="dt">mxPerc=</span><span class="fl">0.5</span>) {
    nrRecords &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">dbGetQuery</span>(dbConn, <span class="kw">paste</span>(<span class="st">&quot;select count(*) from&quot;</span>,tbl)))
    
    if (percORn &lt;<span class="st"> </span><span class="dv">1</span>)
        if (percORn &gt;<span class="st"> </span>mxPerc) 
            <span class="kw">stop</span>(<span class="st">&quot;This function is not adequate for that big samples.&quot;</span>)
        else percORn &lt;-<span class="st"> </span><span class="kw">as.integer</span>(percORn*nrRecords)
    perc &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">2</span>*percORn/nrRecords, mxPerc)
    
    dt &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dbConn,<span class="kw">paste</span>(<span class="st">&quot;select * from (select * from&quot;</span>,tbl,
                                  <span class="st">&quot;where rand() &lt;= &quot;</span>,perc,<span class="st">&quot;) as t limit &quot;</span>,percORn))
    if (<span class="kw">nrow</span>(dt) !=<span class="st"> </span>percORn) 
        <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&quot;Expecting&quot;</span>,percORn,<span class="st">&quot;rows, but got&quot;</span>,<span class="kw">nrow</span>(dt)))
    dt
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t1 &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()
d &lt;-<span class="st"> </span><span class="kw">sampleDBMS</span>(con,<span class="st">&quot;sensor_values&quot;</span>,<span class="dv">10000</span>)
<span class="kw">Sys.time</span>()-t1
<span class="kw">nrow</span>(d)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbDisconnect</span>(con)  
<span class="kw">dbUnloadDriver</span>(drv)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(CORElearn)
<span class="kw">data</span>(iris)
<span class="kw">attrEval</span>(Species ~<span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;GainRatio&quot;</span>)
<span class="kw">attrEval</span>(Species ~<span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;InfGain&quot;</span>)
<span class="kw">attrEval</span>(Species ~<span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;Gini&quot;</span>)
<span class="kw">attrEval</span>(Species ~<span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;MDL&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">infoCore</span>(<span class="dt">what=</span><span class="st">&quot;attrEval&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package =</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">attrEval</span>(a1 ~<span class="st"> </span>., algae[,<span class="dv">1</span>:<span class="dv">12</span>], <span class="dt">estimator=</span><span class="st">&quot;MSEofMean&quot;</span>)
<span class="kw">attrEval</span>(a1 ~<span class="st"> </span>., algae[,<span class="dv">1</span>:<span class="dv">12</span>], <span class="dt">estimator=</span><span class="st">&quot;RReliefFexpRank&quot;</span>)
<span class="kw">infoCore</span>(<span class="dt">what=</span><span class="st">&quot;attrEvalReg&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
pca.data &lt;-<span class="st"> </span>iris[,-<span class="dv">5</span>] <span class="co"># each case is described by the first 4 variables</span>
pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(pca.data)
<span class="kw">loadings</span>(pca)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca$scores[<span class="dv">1</span>:<span class="dv">5</span>,]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(iris)
reduced.iris &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pca$scores[,<span class="dv">1</span>:<span class="dv">2</span>],<span class="dt">Species=</span>iris$Species)
<span class="kw">dim</span>(reduced.iris)
<span class="kw">head</span>(reduced.iris)</code></pre></div>
<!-- modeling.Rnw -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_template$<span class="kw">set</span>(<span class="dt">onlyShow=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>, <span class="dt">eval=</span><span class="ot">FALSE</span>,  <span class="dt">tidy=</span><span class="ot">FALSE</span>),
                  <span class="dt">onlyRun=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>),
                  <span class="dt">showFig=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">6</span>,<span class="dt">fig.height=</span><span class="dv">6</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.7</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">showFig2=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">12</span>,<span class="dt">fig.height=</span><span class="dv">6</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.9</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">showFig3=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">8</span>,<span class="dt">fig.height=</span><span class="dv">8</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.9</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">runShow=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>, <span class="dt">tidy=</span><span class="ot">FALSE</span>))
<span class="kw">library</span>(dplyr)</code></pre></div>
</div>
</div>
<div id="modeling" class="section level3">
<h3>Modeling</h3>
<div id="exploratory-data-analysis" class="section level4">
<h4>Exploratory Data Analysis</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae,<span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">mean</span>(algae$a1)
<span class="kw">mean</span>(algae$NO3)
<span class="kw">mean</span>(algae$NO3, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">median</span>(algae$a3)
<span class="kw">median</span>(algae$mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
alg &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(algae)
<span class="kw">summarise</span>(alg, <span class="dt">avgNO3=</span><span class="kw">mean</span>(NO3,<span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">medA1=</span><span class="kw">median</span>(a1))
<span class="kw">select</span>(alg, mxPH:Cl) %&gt;%<span class="st">  </span>
<span class="st">    </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="kw">median</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(alg, season, size) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">nObs=</span><span class="kw">n</span>(), <span class="dt">mA7=</span><span class="kw">median</span>(a7)) %&gt;%<span class="st"> </span>
<span class="st">        </span><span class="kw">ungroup</span>() %&gt;%<span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mA7))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Mode &lt;-<span class="st"> </span>function(x, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>) {
  if(na.rm) x &lt;-<span class="st"> </span>x[!<span class="kw">is.na</span>(x)]
  ux &lt;-<span class="st"> </span><span class="kw">unique</span>(x)
  <span class="kw">return</span>(ux[<span class="kw">which.max</span>(<span class="kw">tabulate</span>(<span class="kw">match</span>(x, ux)))])
}
<span class="kw">Mode</span>(algae$mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">Mode</span>(algae$season)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DMwR2)
<span class="kw">centralValue</span>(algae$a1)
<span class="kw">centralValue</span>(algae$speed)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(algae$a1)
<span class="kw">sd</span>(algae$Cl, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">IQR</span>(algae$mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
<span class="kw">quantile</span>(algae$a3)
<span class="kw">quantile</span>(algae$a3, <span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))
<span class="kw">range</span>(algae$a1)
<span class="kw">max</span>(algae$a5)-<span class="kw">min</span>(algae$a5)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(alg,a1:a7) %&gt;%<span class="st"> </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(var))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="kw">group_by</span>(iris,Species) %&gt;%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">qs=</span><span class="kw">quantile</span>(Sepal.Length))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(iris$Sepal.Length, <span class="kw">list</span>(<span class="dt">Species=</span>iris$Species), quantile)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(Sepal.Length ~<span class="st"> </span>Species, <span class="dt">data=</span>iris, quantile)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
nasRow &lt;-<span class="st"> </span><span class="kw">apply</span>(algae,<span class="dv">1</span>,function(r) <span class="kw">sum</span>(<span class="kw">is.na</span>(r)))
<span class="kw">cat</span>(<span class="st">&quot;The Algae dataset contains &quot;</span>,<span class="kw">sum</span>(nasRow),<span class="st">&quot; NA values.</span><span class="ch">\n</span><span class="st">&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;There are &quot;</span>,<span class="kw">sum</span>(!<span class="kw">complete.cases</span>(algae)),
    <span class="st">&quot; rows that have at least one NA value.</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bpRule &lt;-<span class="st"> </span>function(x, <span class="dt">const=</span><span class="fl">1.5</span>, <span class="dt">positions=</span><span class="ot">FALSE</span>) { 
    x &lt;-<span class="st"> </span>x[!<span class="kw">is.na</span>(x)]
    qs &lt;-<span class="st"> </span><span class="kw">quantile</span>(x,<span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))
    iqr &lt;-<span class="st"> </span>qs[<span class="dv">2</span>]-qs[<span class="dv">1</span>]
    if (!positions) x[x &lt;<span class="st"> </span>qs[<span class="dv">1</span>]-const*iqr |<span class="st"> </span>x &gt;<span class="st"> </span>qs[<span class="dv">2</span>]+const*iqr]
    else <span class="kw">which</span>(x &lt;<span class="st"> </span>qs[<span class="dv">1</span>]-const*iqr |<span class="st"> </span>x &gt;<span class="st"> </span>qs[<span class="dv">2</span>]+const*iqr)
}
<span class="kw">bpRule</span>(algae$a1)
<span class="kw">bpRule</span>(algae$NO3)
<span class="kw">bpRule</span>(algae$NO3, <span class="dt">positions=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="kw">summary</span>(iris)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Hmisc)
<span class="kw">describe</span>(iris)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>(algae[,<span class="dv">2</span>:<span class="dv">5</span>], algae$season,summary)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pdf</span>(<span class="st">&quot;myplot.pdf&quot;</span>)
<span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)
<span class="kw">dev.off</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">jpeg</span>(<span class="st">&quot;myplot.jpg&quot;</span>)
<span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)
<span class="kw">dev.off</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(iris)
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length, <span class="dt">y=</span>Petal.Width, <span class="dt">color=</span>Species)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">4</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
## Plot on the left (standard)
freqOcc &lt;-<span class="st"> </span><span class="kw">table</span>(algae$season)
<span class="kw">barplot</span>(freqOcc,<span class="dt">main=</span><span class="st">&#39;Frequency of the Seasons&#39;</span>)
## Plot on the right (ggplot2)
<span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
freqOcc &lt;-<span class="st"> </span><span class="kw">table</span>(algae$season)

gh &lt;-<span class="st"> </span><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),
               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)
<span class="kw">barplot</span>(freqOcc,<span class="dt">main=</span><span class="st">&#39;Frequency of the Seasons&#39;</span>)
<span class="kw">print</span>(gh,<span class="dt">vp=</span>vp)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>) +<span class="st"> </span><span class="kw">coord_flip</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(iris)
## Plot on the left (standard)
<span class="kw">hist</span>(iris$Petal.Length,<span class="dt">xlab=</span><span class="st">&#39;Petal Length&#39;</span>)
## Plot on the right (ggplot2)
<span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length)) +<span class="st"> </span><span class="kw">geom_histogram</span>() +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">data</span>(iris)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length)) +<span class="st"> </span><span class="kw">geom_histogram</span>() +<span class="kw">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),
               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)
<span class="kw">hist</span>(iris$Petal.Length,<span class="dt">xlab=</span><span class="st">&#39;Petal Length&#39;</span>)
<span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(iris)
## Plot on the left (standard)
<span class="kw">boxplot</span>(iris$Sepal.Width, <span class="dt">ylab=</span><span class="st">&#39;Sepal Width&#39;</span>)
## Plot on the right (ggplot2)
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(<span class="dv">0</span>), <span class="dt">y=</span>Sepal.Width)) +<span class="st"> </span><span class="kw">geom_boxplot</span>() +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>())</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">data</span>(iris)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(<span class="dv">0</span>),<span class="dt">y=</span>Sepal.Width)) +<span class="st"> </span><span class="kw">geom_boxplot</span>() +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>())
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),
               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)
<span class="kw">boxplot</span>(iris$Sepal.Width,<span class="dt">ylab=</span><span class="st">&#39;Sepal Width&#39;</span>)
<span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(iris)
## Plot on the left (standard)
<span class="kw">boxplot</span>(Sepal.Length ~<span class="st"> </span>Species, iris, <span class="dt">ylab=</span><span class="st">&quot;Sepal.Length&quot;</span>)
## Plot on the right (ggplot2)
<span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Species,<span class="dt">y=</span>Sepal.Length)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">data</span>(iris)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Species,<span class="dt">y=</span>Sepal.Length)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),
               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)
<span class="kw">boxplot</span>(Sepal.Length ~<span class="st"> </span>Species, iris, <span class="dt">ylab=</span><span class="st">&quot;Sepal.Length&quot;</span>)
<span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>a1)) +<span class="st"> </span><span class="kw">geom_histogram</span>() +<span class="st"> </span><span class="kw">facet_grid</span>(size ~<span class="st"> </span>speed)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>a1)) +<span class="st"> </span><span class="kw">geom_histogram</span>() +<span class="st"> </span><span class="kw">facet_grid</span>(size ~<span class="st"> </span>speed)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(iris)
## Plot on the left (standard)
<span class="kw">plot</span>(iris$Sepal.Length,iris$Sepal.Width,
     <span class="dt">main=</span><span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;Sepal Length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal Width&quot;</span>)
## Plot on the right (ggplot2)
<span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length,<span class="dt">y=</span>Sepal.Width)) +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">data</span>(iris)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length,<span class="dt">y=</span>Sepal.Width)) +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),
               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)
<span class="kw">plot</span>(iris$Sepal.Length,iris$Sepal.Width,
     <span class="dt">main=</span><span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;Sepal Length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal Width&quot;</span>)
<span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
## Plot on the left (standard)
<span class="kw">plot</span>(algae$a1, algae$a2, <span class="dt">col=</span>algae$season,
     <span class="dt">main=</span><span class="st">&quot;Relationship between A1 and A2 by Season&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;A1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A2&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae$season),
       <span class="dt">col=</span><span class="kw">palette</span>()[<span class="dv">1</span>:<span class="kw">nlevels</span>(algae$season)],<span class="dt">pch=</span><span class="dv">1</span>)
## Plot on the right (ggplot2)
<span class="kw">plot</span>(algae$a4, algae$a7, <span class="dt">pch=</span><span class="kw">as.integer</span>(algae$speed), 
     <span class="dt">main=</span><span class="st">&quot;Relationship between A4 and A7 by River Speed&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;A4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A7&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae$speed),
      <span class="dt">pch=</span><span class="dv">1</span>:<span class="kw">nlevels</span>(algae$season))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
## Plot on the left (standard)
<span class="kw">plot</span>(algae$a1, algae$a2, <span class="dt">col=</span>algae$season,
     <span class="dt">main=</span><span class="st">&quot;Relationship between A1 and A2 by Season&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;A1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A2&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae$season),
       <span class="dt">col=</span><span class="kw">palette</span>()[<span class="dv">1</span>:<span class="kw">nlevels</span>(algae$season)],<span class="dt">pch=</span><span class="dv">1</span>)
## Plot on the right (ggplot2)
<span class="kw">plot</span>(algae$a4, algae$a7, <span class="dt">pch=</span><span class="kw">as.integer</span>(algae$speed), 
     <span class="dt">main=</span><span class="st">&quot;Relationship between A4 and A7 by River Speed&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;A4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A7&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae$speed),
      <span class="dt">pch=</span><span class="dv">1</span>:<span class="kw">nlevels</span>(algae$season))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">ggplot</span>(algae, <span class="kw">aes</span>(<span class="dt">x=</span>a1,<span class="dt">y=</span>a2,<span class="dt">color=</span>season)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>season)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">pairs</span>(algae[,<span class="dv">12</span>:<span class="dv">16</span>])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">pairs</span>(algae[,<span class="dv">12</span>:<span class="dv">16</span>])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">12</span>:<span class="dv">16</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">12</span>:<span class="dv">16</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">2</span>:<span class="dv">5</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">2</span>:<span class="dv">5</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggparcoord</span>(algae,<span class="dt">columns=</span><span class="dv">12</span>:<span class="dv">18</span>,<span class="dt">groupColumn=</span><span class="st">&quot;season&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">library</span>(dplyr)
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">ggparcoord</span>(algae,<span class="dt">columns=</span><span class="dv">12</span>:<span class="dv">18</span>,<span class="dt">groupColumn=</span><span class="st">&quot;season&quot;</span>)</code></pre></div>
</div>
<div id="dependency-modeling-using-association-rules" class="section level4">
<h4>Dependency Modeling using Association Rules</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arules)
<span class="kw">library</span>(dplyr)
<span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)
b &lt;-<span class="st"> </span>Boston
b$chas &lt;-<span class="st"> </span><span class="kw">factor</span>(b$chas,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;river&quot;</span>,<span class="st">&quot;noriver&quot;</span>))
b$rad &lt;-<span class="st"> </span><span class="kw">factor</span>(b$rad)
b$black &lt;-<span class="st"> </span><span class="kw">cut</span>(b$black,<span class="dt">breaks=</span><span class="dv">4</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;&gt;31.5%&quot;</span>,<span class="st">&quot;18.5-31.5%&quot;</span>,<span class="st">&quot;8-18.5%&quot;</span>,<span class="st">&quot;&lt;8%&quot;</span>))
discr &lt;-<span class="st"> </span>function(x) <span class="kw">cut</span>(x,<span class="dt">breaks=</span><span class="dv">4</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medLow&quot;</span>,<span class="st">&quot;medHigh&quot;</span>,<span class="st">&quot;high&quot;</span>))
b &lt;-<span class="st"> </span><span class="kw">select</span>(b,-<span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;chas&quot;</span>,<span class="st">&quot;rad&quot;</span>,<span class="st">&quot;black&quot;</span>))) %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">mutate_each</span>(<span class="kw">funs</span>(discr)) %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">bind_cols</span>(<span class="kw">select</span>(b,<span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;chas&quot;</span>,<span class="st">&quot;rad&quot;</span>,<span class="st">&quot;black&quot;</span>))))
b &lt;-<span class="st"> </span><span class="kw">as</span>(b,<span class="st">&quot;transactions&quot;</span>)
b</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(b)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">itemFrequencyPlot</span>(b, <span class="dt">support=</span><span class="fl">0.3</span>,<span class="dt">cex.names=</span><span class="fl">0.8</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">itemFrequencyPlot</span>(b, <span class="dt">support=</span><span class="fl">0.3</span>,<span class="dt">cex.names=</span><span class="fl">0.8</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ars &lt;-<span class="st"> </span><span class="kw">apriori</span>(b, <span class="dt">parameter=</span><span class="kw">list</span>(<span class="dt">support=</span><span class="fl">0.025</span>, <span class="dt">confidence=</span><span class="fl">0.75</span>))
ars</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">discr</span>(Boston$medv))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs %in%<span class="st"> &quot;medv=high&quot;</span>),<span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs %in%<span class="st"> &quot;medv=low&quot;</span>),<span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>lhs %in%<span class="st"> &quot;nox=high&quot;</span> |<span class="st"> </span>rhs %in%<span class="st"> &quot;nox=high&quot;</span>),
             <span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arulesViz)
<span class="kw">plot</span>(ars)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arulesViz)
<span class="kw">plot</span>(ars)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars,
               <span class="dt">subset=</span>rhs %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;medv=high&quot;</span>,<span class="st">&quot;medv=medHigh&quot;</span>) &amp;<span class="st"> </span>confidence&gt;<span class="fl">0.75</span>)
<span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;matrix&quot;</span>, <span class="dt">measure=</span><span class="st">&quot;lift&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars,<span class="dt">subset=</span>rhs %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;medv=high&quot;</span>,<span class="st">&quot;medv=medHigh&quot;</span>) &amp;<span class="st"> </span>confidence&gt;<span class="fl">0.75</span>)
<span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;matrix&quot;</span>, <span class="dt">measure=</span><span class="st">&quot;lift&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs %in%<span class="st"> &quot;medv=high&quot;</span> &amp;<span class="st"> </span>confidence &gt;<span class="st"> </span><span class="fl">0.95</span>)
<span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;graph&quot;</span>, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;itemsets&quot;</span>))</code></pre></div>
</div>
<div id="clustering" class="section level4">
<h4>Clustering</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
randDat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>), <span class="dt">nrow=</span><span class="dv">5</span>)
<span class="kw">dist</span>(randDat) <span class="co"># Euclidean distance (default)</span>
<span class="kw">dist</span>(randDat, <span class="dt">method=</span><span class="st">&quot;manhattan&quot;</span>)
<span class="kw">dist</span>(randDat, <span class="dt">method=</span><span class="st">&quot;minkowski&quot;</span>, <span class="dt">p=</span><span class="dv">4</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>) <span class="co"># setting a seed for the random number generator</span>
<span class="kw">data</span>(iris)
ir3 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris[,-<span class="dv">5</span>], <span class="dt">centers=</span><span class="dv">3</span>, <span class="dt">iter.max=</span><span class="dv">200</span>) <span class="co"># not using Species info.</span>
ir3</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(ir3$cluster, iris$Species)
cm &lt;-<span class="st"> </span><span class="kw">table</span>(ir3$cluster, iris$Species)
<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cluster)
s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(ir3$cluster, <span class="kw">dist</span>(iris[,-<span class="dv">5</span>]))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(s)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
d &lt;-<span class="st"> </span><span class="kw">dist</span>(iris[,-<span class="dv">5</span>])
avgS &lt;-<span class="st"> </span><span class="kw">c</span>()
for(k in <span class="dv">2</span>:<span class="dv">6</span>) {
   cl &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris[,-<span class="dv">5</span>],<span class="dt">centers=</span>k,<span class="dt">iter.max=</span><span class="dv">200</span>)
   s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(cl$cluster,d)
   avgS &lt;-<span class="st"> </span><span class="kw">c</span>(avgS,<span class="kw">mean</span>(s[,<span class="dv">3</span>]))
}
<span class="kw">data.frame</span>(<span class="dt">nClus=</span><span class="dv">2</span>:<span class="dv">6</span>,<span class="dt">Silh=</span>avgS)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cluster)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
pc &lt;-<span class="st"> </span><span class="kw">pam</span>(iris[,-<span class="dv">5</span>],<span class="dt">k=</span><span class="dv">3</span>)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(pc$clustering, iris$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))
pc$silinfo$avg.width</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fpc)
<span class="kw">data</span>(iris)
sol &lt;-<span class="st"> </span><span class="kw">pamk</span>(iris[,-<span class="dv">5</span>], <span class="dt">krange=</span><span class="dv">2</span>:<span class="dv">10</span>, <span class="dt">criterion=</span><span class="st">&quot;asw&quot;</span>, <span class="dt">usepam=</span><span class="ot">TRUE</span>)
sol</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">scale</span>(iris[,-<span class="dv">5</span>]))
h &lt;-<span class="st"> </span><span class="kw">hclust</span>(d)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h,<span class="dt">hang=</span>-<span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.5</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h,<span class="dt">hang=</span>-<span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.4</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clus3 &lt;-<span class="st"> </span><span class="kw">cutree</span>(h, <span class="dv">3</span>)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(clus3, iris$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h,<span class="dt">hang=</span>-<span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.5</span>)
<span class="kw">rect.hclust</span>(h,<span class="dt">k=</span><span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h,<span class="dt">hang=</span>-<span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.4</span>)
<span class="kw">rect.hclust</span>(h,<span class="dt">k=</span><span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
d &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">scale</span>(iris[,-<span class="dv">5</span>]))
methds &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;complete&#39;</span>,<span class="st">&#39;single&#39;</span>,<span class="st">&#39;average&#39;</span>)
avgS &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">ncol=</span><span class="dv">3</span>,<span class="dt">nrow=</span><span class="dv">5</span>,
               <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="dv">2</span>:<span class="dv">6</span>,methds))
for(k in <span class="dv">2</span>:<span class="dv">6</span>) 
  for(m in <span class="kw">seq_along</span>(methds)) {
    h &lt;-<span class="st"> </span><span class="kw">hclust</span>(d,<span class="dt">meth=</span>methds[m])
    c &lt;-<span class="st"> </span><span class="kw">cutree</span>(h,k)
    s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(c,d)
    avgS[k<span class="dv">-1</span>,m] &lt;-<span class="st"> </span><span class="kw">mean</span>(s[,<span class="dv">3</span>])
  }
avgS</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">di &lt;-<span class="st"> </span><span class="kw">diana</span>(iris[,-<span class="dv">5</span>], <span class="dt">metric=</span><span class="st">&#39;euclidean&#39;</span>, <span class="dt">stand=</span><span class="ot">TRUE</span>)
di3 &lt;-<span class="st"> </span><span class="kw">cutree</span>(di, <span class="dv">3</span>)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(di3, iris$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cm &lt;-<span class="st"> </span>cm[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>),]
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fpc)
d &lt;-<span class="st"> </span><span class="kw">scale</span>(iris[,-<span class="dv">5</span>])
db &lt;-<span class="st"> </span><span class="kw">dbscan</span>(d, <span class="dt">eps=</span><span class="fl">0.9</span>, <span class="dt">MinPts=</span><span class="dv">5</span>)
db
<span class="kw">table</span>(db$cluster,iris$Species)</code></pre></div>
</div>
<div id="anomaly-detection" class="section level4">
<h4>Anomaly Detection</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grubbs.outliers &lt;-<span class="st"> </span>function(x, <span class="dt">p.thresh=</span><span class="fl">0.05</span>) {
    <span class="kw">require</span>(outliers, <span class="dt">quietly=</span><span class="ot">TRUE</span>)
    x &lt;-<span class="st"> </span>x[!<span class="kw">is.na</span>(x)]
    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
    zs &lt;-<span class="st"> </span><span class="kw">abs</span>(x -<span class="st"> </span><span class="kw">mean</span>(x)) /<span class="st"> </span><span class="kw">sd</span>(x)
    outs &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sapply</span>(zs, function(z) <span class="kw">pgrubbs</span>(z, n, <span class="dt">type=</span><span class="dv">10</span>))
    posOuts &lt;-<span class="st"> </span><span class="kw">which</span>(outs &lt;=<span class="st"> </span>p.thresh)
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">zs=</span>zs, 
                <span class="dt">pvals=</span>outs, 
                <span class="dt">outliers=</span>x[posOuts],
                <span class="dt">positions=</span>posOuts))
}
<span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">grubbs.outliers</span>(algae$a2)$outliers</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)
<span class="kw">table</span>(algae$season)/<span class="kw">length</span>(algae$season)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dbscan.outliers &lt;-<span class="st"> </span>function(data, ...) {
    <span class="kw">require</span>(fpc, <span class="dt">quietly=</span><span class="ot">TRUE</span>)
    cl &lt;-<span class="st"> </span><span class="kw">dbscan</span>(data, ...)
    posOuts &lt;-<span class="st"> </span><span class="kw">which</span>(cl$cluster ==<span class="st"> </span><span class="dv">0</span>)
    <span class="kw">list</span>(<span class="dt">positions =</span> posOuts,
         <span class="dt">outliers =</span> data[posOuts,], 
         <span class="dt">dbscanResults =</span> cl)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(forcats)
<span class="kw">data</span>(Glass, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)
<span class="kw">count</span>(Glass,Type)  <span class="co"># a dplyr  alternative to &quot;table(Glass$Type)&quot;</span>
g &lt;-<span class="st"> </span><span class="kw">mutate</span>(Glass,
            <span class="dt">Type=</span><span class="kw">fct_collapse</span>(Type,
                              <span class="dt">rare   =</span> <span class="kw">as.character</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)),
                              <span class="dt">normal =</span> <span class="kw">as.character</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>))
                              )
            )
g %&gt;%<span class="st"> </span><span class="kw">count</span>(Type) %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">prop=</span><span class="dv">100</span>*n/<span class="kw">nrow</span>(g))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outs &lt;-<span class="st"> </span><span class="kw">dbscan.outliers</span>(g[,-<span class="dv">10</span>], <span class="dt">eps=</span><span class="dv">1</span>, <span class="dt">scale=</span><span class="ot">TRUE</span>)
<span class="kw">head</span>(outs$outliers)
<span class="kw">nrow</span>(outs$outliers)
<span class="kw">slice</span>(g, outs$positions) %&gt;%<span class="st">  </span><span class="kw">count</span>(Type)
<span class="kw">count</span>(g, Type)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DMwR2)
<span class="kw">library</span>(dplyr)
og &lt;-<span class="st"> </span><span class="kw">outliers.ranking</span>(<span class="kw">select</span>(g, -Type))
<span class="kw">slice</span>(g, og$rank.outliers[<span class="dv">1</span>:<span class="dv">40</span>]) %&gt;%<span class="st">  </span><span class="kw">count</span>(Type)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DMwR2)
<span class="kw">library</span>(dplyr)
lof.scores &lt;-<span class="st"> </span><span class="kw">lofactor</span>(<span class="kw">select</span>(g, -Type),<span class="dv">10</span>)
<span class="kw">slice</span>(g, <span class="kw">order</span>(lof.scores,<span class="dt">decreasing=</span><span class="ot">TRUE</span>)[<span class="dv">1</span>:<span class="dv">40</span>]) %&gt;%<span class="st">  </span><span class="kw">count</span>(Type)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(UBL)
<span class="kw">library</span>(dplyr)
<span class="kw">count</span>(g,Type)
## Undersampling the largest class
newg &lt;-<span class="st"> </span><span class="kw">RandUnderClassif</span>(Type ~<span class="st"> </span>., g)
<span class="kw">count</span>(newg,Type)
## Now specifying the degree of undersampling by hand
newg2 &lt;-<span class="st"> </span><span class="kw">RandUnderClassif</span>(Type ~<span class="st"> </span>., g, <span class="kw">list</span>(<span class="dt">normal=</span><span class="fl">0.4</span>, <span class="dt">rare=</span><span class="dv">1</span>))
<span class="kw">count</span>(newg2,Type)
## Oversampling the minority class
newg3 &lt;-<span class="st"> </span><span class="kw">RandOverClassif</span>(Type ~<span class="st"> </span>.,g)
<span class="kw">count</span>(newg3,Type)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(e1071)
trainD &lt;-<span class="st"> </span><span class="kw">filter</span>(g, Type ==<span class="st"> &quot;normal&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">select</span>(-Type) 
s &lt;-<span class="st"> </span><span class="kw">svm</span>(trainD, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">type=</span><span class="st">&quot;one-classification&quot;</span>, <span class="dt">nu=</span><span class="fl">0.5</span>)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(g$Type, <span class="kw">predict</span>(s,<span class="kw">select</span>(g, -Type))))</code></pre></div>
</div>
<div id="predictive-analytics" class="section level4">
<h4>Predictive Analytics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DMwR2)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
<span class="kw">data</span>(iris)
ct1 &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species ~<span class="st"> </span>., iris)
ct2 &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species ~<span class="st"> </span>., iris, <span class="dt">se=</span><span class="dv">0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpart.plot)
<span class="kw">prp</span>(ct1, <span class="dt">type=</span><span class="dv">0</span>, <span class="dt">extra=</span><span class="dv">101</span>)  <span class="co"># left tree</span>
<span class="kw">prp</span>(ct2, <span class="dt">type=</span><span class="dv">0</span>, <span class="dt">extra=</span><span class="dv">101</span>)  <span class="co"># right tree</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpart.plot)
<span class="kw">par</span>( <span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) )
<span class="kw">prp</span>(ct1,<span class="dt">type=</span><span class="dv">0</span>,<span class="dt">extra=</span><span class="dv">101</span>) 
<span class="kw">prp</span>(ct2,<span class="dt">type=</span><span class="dv">0</span>,<span class="dt">extra=</span><span class="dv">101</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris),<span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]
ct &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species ~<span class="st"> </span>., tr, <span class="dt">se=</span><span class="fl">0.5</span>)
ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(ct, ts)
<span class="kw">head</span>(ps1)
ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(ct, ts, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)
<span class="kw">head</span>(ps2)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps2, ts$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(e1071)
<span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]
s &lt;-<span class="st"> </span><span class="kw">svm</span>(Species ~<span class="st"> </span>., tr)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(s, ts)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s2 &lt;-<span class="st"> </span><span class="kw">svm</span>(Species ~<span class="st"> </span>., tr, <span class="dt">cost=</span><span class="dv">10</span>, <span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="dt">degree=</span><span class="dv">3</span>)
ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(s2, ts)
(cm2 &lt;-<span class="st"> </span><span class="kw">table</span>(ps2, ts$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm2))/<span class="kw">sum</span>(cm2))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(Boston),<span class="dv">354</span>)
tr &lt;-<span class="st"> </span>Boston[sp,]
ts &lt;-<span class="st"> </span>Boston[-sp,]
s1 &lt;-<span class="st"> </span><span class="kw">svm</span>(medv ~<span class="st"> </span>., tr)
ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(s1, ts)
<span class="kw">mean</span>(<span class="kw">abs</span>(ps1-ts$medv))
s2 &lt;-<span class="st"> </span><span class="kw">svm</span>(medv ~<span class="st"> </span>., tr, <span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="dt">cost=</span><span class="dv">10</span>, <span class="dt">epsilon=</span><span class="fl">0.02</span>, <span class="dt">gamma=</span><span class="fl">0.01</span>)
ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(s2, ts)
<span class="kw">mean</span>(<span class="kw">abs</span>(ps2-ts$medv))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nnet)
<span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]
n &lt;-<span class="st"> </span><span class="kw">nnet</span>(Species ~<span class="st"> </span>., tr, <span class="dt">size=</span><span class="dv">6</span> ,<span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">maxit=</span><span class="dv">1000</span>)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(n, ts, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(Boston),<span class="dv">354</span>)
tr &lt;-<span class="st"> </span>Boston[sp,]
ts &lt;-<span class="st"> </span>Boston[-sp,]
nr &lt;-<span class="st"> </span><span class="kw">nnet</span>(medv ~<span class="st"> </span>., tr, <span class="dt">linout=</span><span class="ot">TRUE</span>, <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">size=</span><span class="dv">6</span>, <span class="dt">decay=</span><span class="fl">0.01</span>, <span class="dt">maxit=</span><span class="dv">2000</span>)
psnr &lt;-<span class="st"> </span><span class="kw">predict</span>(nr, ts)
<span class="kw">mean</span>(<span class="kw">abs</span>(psnr-ts$medv))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(NeuralNetTools)
## Feature importance (left graph)
<span class="kw">garson</span>(nr) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) 
## Network diagram (rigth graph)
<span class="kw">plotnet</span>(nr)    </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(h2o)
h2oInstance &lt;-<span class="st"> </span><span class="kw">h2o.init</span>(<span class="dt">ip=</span><span class="st">&quot;localhost&quot;</span>)  <span class="co"># start H2O instance locally</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
trH  &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(iris[rndSample, ],<span class="st">&quot;trH&quot;</span>)
tsH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(iris[-rndSample, ],<span class="st">&quot;tsH&quot;</span>)
mdl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x=</span><span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">y=</span><span class="dv">5</span>, <span class="dt">training_frame=</span>trH)
preds &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(mdl,tsH)[,<span class="st">&quot;predict&quot;</span>]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.vector</span>(preds), <span class="kw">as.vector</span>(tsH$Species)))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(h2o)
h2oInstance &lt;-<span class="st"> </span><span class="kw">h2o.init</span>(<span class="dt">ip=</span><span class="st">&quot;localhost&quot;</span>) <span class="co"># start H2O instance locally</span>
<span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(Boston), <span class="dv">354</span>)
trH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(Boston[rndSample, ],<span class="st">&quot;trH&quot;</span>)
tsH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(Boston[-rndSample, ],<span class="st">&quot;tsH&quot;</span>)
mdl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x=</span><span class="dv">1</span>:<span class="dv">13</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">training_frame=</span>trH, 
                        <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>, <span class="dv">100</span>), <span class="dt">epochs=</span><span class="dv">500</span>)
preds &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">h2o.predict</span>(mdl,tsH))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">abs</span>(preds-<span class="kw">as.vector</span>(tsH$medv)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(adabag)
<span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]
 m &lt;-<span class="st"> </span><span class="kw">bagging</span>(Species ~<span class="st"> </span>., tr, <span class="dt">mfinal=</span><span class="dv">500</span>)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m,ts)
<span class="kw">names</span>(ps)
ps$confusion
ps$error*<span class="dv">100</span> <span class="co"># percentage of errors</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ipred)
<span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(Boston),<span class="dv">354</span>)
tr &lt;-<span class="st"> </span>Boston[sp,]
ts &lt;-<span class="st"> </span>Boston[-sp,]
m &lt;-<span class="st"> </span><span class="kw">bagging</span>(medv ~<span class="st"> </span>., tr, <span class="dt">nbagg=</span><span class="dv">500</span>)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts)
<span class="kw">mean</span>(<span class="kw">abs</span>(ps-ts$medv))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(randomForest)
<span class="kw">library</span>(DMwR2)
<span class="kw">data</span>(BreastCancer, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)
bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">knnImputation</span>(BreastCancer[,-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">11</span>)]), <span class="co"># column 1 is an ID</span>
            <span class="dt">Class=</span>BreastCancer$Class)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(bc), <span class="dv">500</span>)
tr &lt;-<span class="st"> </span>bc[rndSample, ] 
ts &lt;-<span class="st"> </span>bc[-rndSample, ]
m &lt;-<span class="st"> </span><span class="kw">randomForest</span>(Class ~<span class="st"> </span>., tr, <span class="dt">ntree=</span><span class="dv">750</span>)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts)
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts$Class))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(adabag)
<span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]
m1 &lt;-<span class="st"> </span><span class="kw">boosting</span>(Species ~<span class="st"> </span>., tr,  <span class="dt">mfinal=</span><span class="dv">500</span>) <span class="co"># AdaBoost.M1</span>
ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(m1,ts)
ps1$confusion
ps1$error*<span class="dv">100</span> 
m2 &lt;-<span class="st"> </span><span class="kw">boosting</span>(Species ~<span class="st"> </span>., tr, <span class="dt">coeflearn=</span><span class="st">&quot;Zhu&quot;</span>, <span class="dt">mfinal=</span><span class="dv">500</span>) <span class="co"># SAMME</span>
ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(m2,ts)
ps2$confusion
ps2$error*<span class="dv">100</span> </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gbm)
<span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(Boston),<span class="dv">354</span>)
tr &lt;-<span class="st"> </span>Boston[sp,]
ts &lt;-<span class="st"> </span>Boston[-sp,]
m &lt;-<span class="st"> </span><span class="kw">gbm</span>(medv ~<span class="st"> </span>., <span class="dt">data=</span>tr, <span class="dt">n.trees=</span><span class="dv">5000</span>)
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts, <span class="dt">n.trees=</span><span class="dv">5000</span>)
<span class="kw">mean</span>(<span class="kw">abs</span>(ps-ts$medv))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(iris), <span class="dv">100</span>)
tr &lt;-<span class="st"> </span>iris[rndSample, ]
ts &lt;-<span class="st"> </span>iris[-rndSample, ]

m &lt;-<span class="st"> </span><span class="kw">gbm</span>(Species ~<span class="st"> </span>., <span class="dt">data=</span>tr, <span class="dt">n.trees=</span><span class="dv">10000</span>, 
         <span class="dt">cv.folds=</span><span class="dv">5</span>, <span class="dt">n.cores=</span><span class="dv">4</span>)
(best &lt;-<span class="st"> </span><span class="kw">gbm.perf</span>(m, <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">method=</span><span class="st">&quot;cv&quot;</span>))
ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts, <span class="dt">n.trees=</span>best, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)[,,<span class="dv">1</span>]
ps &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">colnames</span>(ps)[<span class="kw">max.col</span>(ps)])
(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts$Species))
<span class="dv">100</span>*(<span class="dv">1</span>-<span class="kw">sum</span>(<span class="kw">diag</span>(cm))/<span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m, <span class="dt">plotit=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(m, <span class="dt">i.var=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>),
       <span class="dt">col=</span><span class="dv">1</span>:<span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(m, <span class="dt">i.var=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>),
       <span class="dt">col=</span><span class="dv">1</span>:<span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span>)</code></pre></div>
<!-- evaluation.Rnw -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_template$<span class="kw">set</span>(<span class="dt">onlyShow=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>, <span class="dt">eval=</span><span class="ot">FALSE</span>,  <span class="dt">tidy=</span><span class="ot">FALSE</span>),
                  <span class="dt">onlyRun=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>),
                  <span class="dt">showFig=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">6</span>,<span class="dt">fig.height=</span><span class="dv">6</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.7</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">showFig2=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">12</span>,<span class="dt">fig.height=</span><span class="dv">6</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.9</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">showFig3=</span><span class="kw">list</span>(<span class="dt">fig.width=</span><span class="dv">8</span>,<span class="dt">fig.height=</span><span class="dv">8</span>,<span class="dt">echo=</span><span class="ot">FALSE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>,<span class="dt">out.width=</span><span class="st">&quot;0.9</span><span class="ch">\\</span><span class="st">textwidth&quot;</span>),
                  <span class="dt">runShow=</span><span class="kw">list</span>(<span class="dt">echo=</span><span class="ot">TRUE</span>, <span class="dt">eval=</span><span class="ot">TRUE</span>, <span class="dt">message=</span><span class="ot">FALSE</span>, <span class="dt">warning=</span><span class="ot">FALSE</span>, <span class="dt">tidy=</span><span class="ot">FALSE</span>))</code></pre></div>
</div>
</div>
<div id="evaluation" class="section level3">
<h3>Evaluation</h3>
<div id="the-holdout-and-random-subsampling" class="section level4">
<h4>The Holdout and Random Subsampling</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(performanceEstimation)
<span class="kw">library</span>(e1071)
<span class="kw">data</span>(iris)
r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(<span class="kw">PredTask</span>(Species ~<span class="st"> </span>., iris),
                           <span class="kw">Workflow</span>(<span class="dt">learner=</span><span class="st">&quot;svm&quot;</span>),
                           <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;err&quot;</span>,<span class="dt">method=</span><span class="kw">Holdout</span>(<span class="dt">hldSz=</span><span class="fl">0.3</span>))
                           )
<span class="kw">summary</span>(r)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(performanceEstimation)
<span class="kw">library</span>(randomForest)
<span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)
r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(<span class="kw">PredTask</span>(medv ~<span class="st"> </span>., Boston),
                           <span class="kw">Workflow</span>(<span class="dt">learner=</span><span class="st">&quot;randomForest&quot;</span>),
                           <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;mse&quot;</span>,
                                          <span class="dt">method=</span><span class="kw">Holdout</span>(<span class="dt">nReps=</span><span class="dv">3</span>,<span class="dt">hldSz=</span><span class="fl">0.3</span>))
                           )
<span class="kw">summary</span>(r)</code></pre></div>
</div>
<div id="cross-validation" class="section level4">
<h4>Cross Validation</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(performanceEstimation)
<span class="kw">library</span>(DMwR2)
<span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)
r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(
         <span class="kw">PredTask</span>(medv ~<span class="st"> </span>., Boston),
         <span class="kw">workflowVariants</span>(<span class="dt">learner=</span><span class="st">&quot;rpartXse&quot;</span>,
                          <span class="dt">learner.pars=</span><span class="kw">list</span>(<span class="dt">se=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>))),
         <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="kw">c</span>(<span class="st">&quot;mse&quot;</span>,<span class="st">&quot;mae&quot;</span>),
                        <span class="dt">method=</span><span class="kw">CV</span>(<span class="dt">nReps=</span><span class="dv">3</span>,<span class="dt">nFolds=</span><span class="dv">10</span>))
     )
<span class="kw">rankWorkflows</span>(r, <span class="dt">top=</span><span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getWorkflow</span>(<span class="st">&quot;rpartXse.v1&quot;</span>, r)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(r)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(r)</code></pre></div>
</div>
<div id="bootstrap-estimates" class="section level4">
<h4>Bootstrap Estimates</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(performanceEstimation)
<span class="kw">library</span>(DMwR2)
<span class="kw">library</span>(e1071)
<span class="kw">data</span>(iris)
<span class="kw">data</span>(BreastCancer, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)
bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">knnImputation</span>(BreastCancer[,-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">11</span>)]), 
            <span class="dt">Class=</span>BreastCancer$Class)
r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(
         <span class="kw">c</span>(<span class="kw">PredTask</span>(Species ~<span class="st"> </span>., iris), 
           <span class="kw">PredTask</span>(Class ~<span class="st"> </span>., bc)),
         <span class="kw">workflowVariants</span>(<span class="dt">learner=</span><span class="st">&quot;svm&quot;</span>,
                          <span class="dt">learner.pars=</span><span class="kw">list</span>(<span class="dt">cost=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>),
                                            <span class="dt">gamma=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.001</span>))),
         <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;acc&quot;</span>,
                        <span class="dt">method=</span><span class="kw">Bootstrap</span>(<span class="dt">nReps=</span><span class="dv">200</span>,<span class="dt">type=</span><span class="st">&quot;.632&quot;</span>))
    )</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">topPerformers</span>(r , <span class="dt">maxs=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="recommended-procedures" class="section level4">
<h4>Recommended Procedures</h4>
<!-- DeployAndReport.Rnw -->
</div>
</div>
<div id="reporting-and-deployment" class="section level3">
<h3>Reporting and Deployment</h3>
<div id="reporting-through-dynamic-documents" class="section level4">
<h4>Reporting Through Dynamic Documents</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rmarkdown)
<span class="kw">render</span>(<span class="st">&quot;myreport.Rmd&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">render</span>(<span class="st">&quot;myreport.Rmd&quot;</span>, <span class="dt">output_format=</span><span class="st">&quot;word_document&quot;</span>)</code></pre></div>
</div>
<div id="deployment-through-web-applications" class="section level4">
<h4>Deployment Through Web Applications</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shiny)
<span class="kw">runApp</span>(<span class="st">&quot;myAppFolderName&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shiny)
<span class="kw">data</span>(iris)

<span class="kw">shinyUI</span>(<span class="kw">fluidPage</span>(
  <span class="kw">titlePanel</span>(<span class="st">&quot;Exploring the Iris dataset&quot;</span>),
  <span class="kw">sidebarLayout</span>(
      <span class="kw">sidebarPanel</span>(
          <span class="kw">selectInput</span>(<span class="st">&quot;var&quot;</span>,
                      <span class="st">&quot;Select a Predictor Variable:&quot;</span>,
                      <span class="dt">choices=</span><span class="kw">colnames</span>(iris)[<span class="dv">1</span>:<span class="dv">4</span>])
      ),
      <span class="kw">mainPanel</span>(
          <span class="kw">plotOutput</span>(<span class="st">&quot;condBP&quot;</span>)
      )
  )
))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shiny)
<span class="kw">data</span>(iris)

<span class="kw">shinyServer</span>(
    function(input, output) 
        {
            output$condBP &lt;-<span class="st"> </span><span class="kw">renderPlot</span>(
                {
                    form &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste</span>(input$var,<span class="st">&quot;~ Species&quot;</span>))
                    <span class="kw">boxplot</span>(form,iris,<span class="dt">ylab=</span>input$var,
                            <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Distribution of&quot;</span>,input$var,
                                <span class="st">&quot;for the different Species&quot;</span>))
                }
            )  
        }
)</code></pre></div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
