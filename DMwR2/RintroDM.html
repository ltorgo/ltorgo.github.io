<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Introduction to Data Mining</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DMwR 2nd Edition</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-indent"></span>
     
    Contents
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Part I - R and Data Mining</li>
    <li>
      <a href="introR.html">Introduction to R</a>
    </li>
    <li>
      <a href="introDM.html">Introduction to Data Mining</a>
    </li>
    <li class="dropdown-header">Part II - Case Studies</li>
    <li>
      <a href="algae.html">Predicting Algae Blooms</a>
    </li>
    <li>
      <a href="stocks.html">Predicting Stock Market Returns</a>
    </li>
    <li>
      <a href="fraud.html">Detecting Fraudulent Transactions</a>
    </li>
    <li>
      <a href="bio.html">Classifying Micro Array Samples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-code"></span>
     
    R Code of Chapters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Part I - R and Data Mining</li>
    <li>
      <a href="RintroR.html">Introduction to R</a>
    </li>
    <li>
      <a href="RintroDM.html">Introduction to Data Mining</a>
    </li>
    <li class="dropdown-header">Part II - Case Studies</li>
    <li>
      <a href="Ralgae.html">Predicting Algae Blooms</a>
    </li>
    <li>
      <a href="Rstocks.html">Predicting Stock Market Returns</a>
    </li>
    <li>
      <a href="Rfraud.html">Detecting Fraudulent Transactions</a>
    </li>
    <li>
      <a href="Rbio.html">Classifying Micro Array Samples</a>
    </li>
  </ul>
</li>
<li>
  <a href="datasets.html">
    <span class="fa fa-database"></span>
     
    Other Information
  </a>
</li>
<li>
  <a href="Errata.html">
    <span class="fa fa-exclamation-triangle"></span>
     
    Errata
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="News.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info-circle"></span>
     
    Contact
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to Data Mining</h1>

</div>


<p>The following is a <a href="RCode/RintroDM.R">script file</a> containing all R code of all sections in this chapter.</p>
<!-- DCandBU.Rnw -->
<div id="a-birds-eye-view-on-data-mining" class="section level3">
<h3>A Bird’s Eye View on Data Mining</h3>
</div>
<div id="data-collection-and-business-understanding" class="section level3">
<h3>Data Collection and Business Understanding</h3>
<div id="data-and-datasets" class="section level4">
<h4>Data and Datasets</h4>
</div>
<div id="importing-data-into-r" class="section level4">
<h4>Importing Data into R</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;x.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">dat</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">class</span>(dat)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;z.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>, <span class="dt">na=</span><span class="st">&quot;???&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">d</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(DBI)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## The DBMS-specific code starts here</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(RMySQL)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  <span class="co"># connecting to the DBMS</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypasswd&quot;</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">## The DBMS-specific code ends here</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">## getting the results of an SQL query as a data frame</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">data &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT * FROM clients&quot;</span>) </a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">## closing up stuff</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw">dbDisconnect</span>(con)  </a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw">dbUnloadDriver</span>(drv)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(DBI)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(RMySQL)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  <span class="co"># connecting to the DBMS</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypasswd&quot;</span>,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">res  &lt;-<span class="st"> </span><span class="kw">dbSendQuery</span>(con,<span class="st">&quot;SELECT * FROM transactions&quot;</span>) </a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="cf">while</span> (<span class="op">!</span><span class="kw">dbHasCompleted</span>(res)) {</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    <span class="co"># get the next 50 records on a data frame</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">    someData &lt;-<span class="st"> </span><span class="kw">fetch</span>(res, <span class="dt">n =</span> <span class="dv">50</span>)  </a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="co"># call some function that handles the current chunk</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    <span class="kw">myProcessingFunction</span>(someData)  </a>
<a class="sourceLine" id="cb4-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw">dbClearResult</span>(res) <span class="co"># clear the results set</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">dbDisconnect</span>(con)  <span class="co"># closing up stuff</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="kw">dbUnloadDriver</span>(drv)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(RMySQL)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">dbConn &lt;-<span class="st"> </span><span class="kw">src_mysql</span>(<span class="st">&quot;sonae&quot;</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                    <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>,<span class="dt">user=</span><span class="st">&quot;prodUser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;myPassword&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">sensors &lt;-<span class="st"> </span><span class="kw">tbl</span>(dbConn,<span class="st">&quot;sensor_values&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sensors <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">    </span><span class="kw">filter</span>(sid<span class="op">==</span><span class="dv">274</span>,value <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(time,value)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;clipboard&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">fc &lt;-<span class="st"> &quot;c:</span><span class="ch">\\</span><span class="st">Documents and Settings</span><span class="ch">\\</span><span class="st">xpto</span><span class="ch">\\</span><span class="st">My Documents</span><span class="ch">\\</span><span class="st">calc.xls&quot;</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">dat &lt;-<span class="st"> </span><span class="kw">read_excel</span>(fc,<span class="dt">sheet=</span><span class="dv">1</span>)</a></code></pre></div>
<!-- dataPP.Rnw -->
</div>
</div>
<div id="data-pre-processing" class="section level3">
<h3>Data Pre-Processing</h3>
<div id="data-cleaning" class="section level4">
<h4>Data Cleaning</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">std &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;stud.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                  <span class="dt">skip=</span><span class="dv">1</span>, <span class="dt">col_names=</span><span class="kw">c</span>(<span class="st">&quot;StudentName&quot;</span>,<span class="st">&quot;Math&quot;</span>,<span class="st">&quot;English&quot;</span>))</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">std</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">stdL &lt;-<span class="st"> </span><span class="kw">gather</span>(std, Subject, Grade, Math<span class="op">:</span>English)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">stdL</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">spread</span>(stdL, Subject, Grade)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;stud2.txt&quot;</span>, <span class="dt">delim=</span><span class="st">&quot; &quot;</span>,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                   <span class="dt">skip=</span><span class="dv">1</span>, <span class="dt">col_names=</span><span class="kw">c</span>(<span class="st">&quot;StudentName&quot;</span>,<span class="st">&quot;Math&quot;</span>,<span class="st">&quot;English&quot;</span>,<span class="st">&quot;Degree_Year&quot;</span>))</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">std2</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">std2L &lt;-<span class="st"> </span><span class="kw">gather</span>(std2, Subject, Grade, Math<span class="op">:</span>English)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">std2L &lt;-<span class="st"> </span><span class="kw">separate</span>(std2L, Degree_Year, <span class="kw">c</span>(<span class="st">&quot;Degree&quot;</span>,<span class="st">&quot;Year&quot;</span>))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">std2L</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">ymd</span>(<span class="st">&quot;20151021&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">ymd</span>(<span class="st">&quot;2015/11/30&quot;</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">myd</span>(<span class="st">&quot;11.2012.3&quot;</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw">dmy_hms</span>(<span class="st">&quot;2/12/2013 14:05:01&quot;</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="kw">mdy</span>(<span class="st">&quot;120112&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">dates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20120521</span>, <span class="st">&quot;2010-12-12&quot;</span>, <span class="st">&quot;2007/01/5&quot;</span>, <span class="st">&quot;2015-2-04&quot;</span>, </a>
<a class="sourceLine" id="cb15-2" data-line-number="2">           <span class="st">&quot;Measured on 2014-12-6&quot;</span>, <span class="st">&quot;2013-7+ 25&quot;</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">dates &lt;-<span class="st"> </span><span class="kw">ymd</span>(dates)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">dates</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">data.frame</span>(<span class="dt">Dates=</span>dates,<span class="dt">WeekDay=</span><span class="kw">wday</span>(dates),<span class="dt">nWeekDay=</span><span class="kw">wday</span>(dates,<span class="dt">label=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">           <span class="dt">Year=</span><span class="kw">year</span>(dates),<span class="dt">Month=</span><span class="kw">month</span>(dates,<span class="dt">label=</span><span class="ot">TRUE</span>))</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">date &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;20150823 18:00:05&quot;</span>,<span class="dt">tz=</span><span class="st">&quot;Europe/Berlin&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">date</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">with_tz</span>(date,<span class="dt">tz=</span><span class="st">&quot;Pacific/Auckland&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">force_tz</span>(date,<span class="dt">tz=</span><span class="st">&quot;Pacific/Auckland&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">uci.repo &lt;-<span class="st"> &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/&quot;</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">dataset &lt;-<span class="st"> &quot;audiology/audiology.standardized&quot;</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">dataF &lt;-<span class="st"> </span><span class="kw">str_c</span>(uci.repo,dataset,<span class="st">&quot;.data&quot;</span>)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">namesF &lt;-<span class="st"> </span><span class="kw">str_c</span>(uci.repo,dataset,<span class="st">&quot;.names&quot;</span>)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">## Reading the data file</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">url</span>(dataF), <span class="dt">col_names=</span><span class="ot">FALSE</span>, <span class="dt">na=</span><span class="st">&quot;?&quot;</span>)</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">data</a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="kw">dim</span>(data)</a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">## Now reading the names file</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">text &lt;-<span class="st"> </span><span class="kw">read_lines</span>(<span class="kw">url</span>(namesF))</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">text[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="kw">length</span>(text)</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">text[<span class="dv">67</span><span class="op">:</span><span class="dv">70</span>]</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">nms &lt;-<span class="st"> </span><span class="kw">str_split_fixed</span>(text[<span class="dv">67</span><span class="op">:</span><span class="dv">135</span>],<span class="st">&quot;:&quot;</span>,<span class="dt">n=</span><span class="dv">2</span>)[,<span class="dv">1</span>] <span class="co"># get the names</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">nms[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">nms &lt;-<span class="st"> </span><span class="kw">str_trim</span>(nms) <span class="co"># trim white space</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">nms[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">nms &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(nms,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(|</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="co"># delete invalid chars.</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">nms[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="kw">colnames</span>(data)[<span class="dv">1</span><span class="op">:</span><span class="dv">69</span>] &lt;-<span class="st"> </span>nms</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">data[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">dat</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">class</span>(dat<span class="op">$</span>Y)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">dat<span class="op">$</span>Y &lt;-<span class="st"> </span><span class="kw">parse_integer</span>(dat<span class="op">$</span>Y, <span class="dt">na=</span><span class="st">&quot;?&quot;</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">dat</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="kw">class</span>(dat<span class="op">$</span>Y)</a></code></pre></div>
</div>
<div id="transforming-variables" class="section level4">
<h4>Transforming Variables</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">iris.stand &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">scale</span>(<span class="kw">select</span>(iris,<span class="op">-</span>Species)),<span class="kw">select</span>(iris,Species))</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="kw">summary</span>(iris.stand)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">mxs &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">select</span>(iris,<span class="op">-</span>Species), <span class="dv">2</span>, max, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">mns &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">select</span>(iris,<span class="op">-</span>Species), <span class="dv">2</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">iris.norm &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">scale</span>(<span class="kw">select</span>(iris,<span class="op">-</span>Species), <span class="dt">center=</span>mns, <span class="dt">scale=</span>mxs<span class="op">-</span>mns),</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">                   <span class="kw">select</span>(iris,Species))</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="kw">summary</span>(iris.norm)</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">library</span>(Hmisc) <span class="co"># for cut2()</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>) <span class="co"># loading the data</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">summary</span>(Boston<span class="op">$</span>age) <span class="co"># the numeric variable we are going to discretize</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">Boston<span class="op">$</span>newAge &lt;-<span class="st"> </span><span class="kw">cut</span>(Boston<span class="op">$</span>age,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">table</span>(Boston<span class="op">$</span>newAge)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">Boston<span class="op">$</span>newAge &lt;-<span class="st"> </span><span class="kw">cut</span>(Boston<span class="op">$</span>age,<span class="dv">5</span>, <span class="co"># alternative using our own labels for the bins</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">                     <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;verynew&quot;</span>,<span class="st">&quot;new&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;old&quot;</span>,<span class="st">&quot;veryold&quot;</span>))</a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="kw">table</span>(Boston<span class="op">$</span>newAge)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">Boston<span class="op">$</span>newAge &lt;-<span class="st"> </span><span class="kw">cut2</span>(Boston<span class="op">$</span>age, <span class="dt">g=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">table</span>(Boston<span class="op">$</span>newAge)</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">Boston<span class="op">$</span>newAge &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">cut2</span>(Boston<span class="op">$</span>age, <span class="dt">g=</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">                        <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;verynew&quot;</span>,<span class="st">&quot;new&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;old&quot;</span>,<span class="st">&quot;veryold&quot;</span>))</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw">table</span>(Boston<span class="op">$</span>newAge)</a></code></pre></div>
</div>
<div id="creating-variables" class="section level4">
<h4>Creating Variables</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">sp500 &lt;-<span class="st"> </span><span class="kw">xts</span>(<span class="kw">c</span>(<span class="fl">1102.94</span>,<span class="fl">1104.49</span>,<span class="fl">1115.71</span>,<span class="fl">1118.31</span>),</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">             <span class="kw">ymd</span>(<span class="kw">c</span>(<span class="st">&quot;2010-02-25&quot;</span>,<span class="st">&quot;2010-02-26&quot;</span>,<span class="st">&quot;2010-03-01&quot;</span>,<span class="st">&quot;2010-03-02&quot;</span>),</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">                 <span class="dt">tz=</span><span class="kw">Sys.getenv</span>(<span class="st">&quot;TZ&quot;</span>))</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">             )</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">sp500</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">sp500[<span class="st">&quot;2010-03-02&quot;</span>]</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">sp500[<span class="st">&quot;2010-03&quot;</span>]</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">sp500[<span class="st">&quot;2010-03-01/&quot;</span>]</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">sp500[<span class="st">&quot;2010-02-26/2010-03-01&quot;</span>]</a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">data</span>(AirPassengers)</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">ap &lt;-<span class="st"> </span><span class="kw">as.xts</span>(AirPassengers)</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">apRel &lt;-<span class="st"> </span><span class="kw">diff</span>(ap)<span class="op">/</span>ap[<span class="op">-</span><span class="kw">length</span>(ap)]</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">head</span>(ap)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">embed</span>(ap,<span class="dv">4</span>))</a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">createEmbedDS &lt;-<span class="st"> </span><span class="cf">function</span>(s, <span class="dt">emb=</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">    d &lt;-<span class="st"> </span><span class="kw">dim</span>(s)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(d) <span class="op">&amp;&amp;</span><span class="st"> </span>d[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;Only applicable to uni-variate time series&quot;</span>)</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">    <span class="cf">if</span> (emb <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">||</span><span class="st"> </span>emb <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(s)) <span class="kw">stop</span>(<span class="st">&quot;Invalid embed size&quot;</span>)</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">    e &lt;-<span class="st"> </span><span class="kw">embed</span>(s,emb)</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">    <span class="kw">colnames</span>(e) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>,<span class="kw">paste</span>(<span class="st">&quot;T&quot;</span>,<span class="dv">1</span><span class="op">:</span>(emb<span class="dv">-1</span>),<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    <span class="cf">if</span> (<span class="kw">is.xts</span>(s)) <span class="kw">return</span>(<span class="kw">xts</span>(e,<span class="kw">index</span>(s)[emb<span class="op">:</span><span class="kw">length</span>(s)])) <span class="cf">else</span> <span class="kw">return</span>(e)</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">dataSet &lt;-<span class="st"> </span><span class="kw">createEmbedDS</span>(ap,<span class="dt">emb=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="kw">head</span>(dataSet)</a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">ff &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;forestFires.txt&quot;</span>)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">ff</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">spatialCoords &lt;-<span class="st"> </span><span class="kw">select</span>(ff,<span class="dt">long=</span>x,<span class="dt">lat=</span>y) <span class="co"># the contextual data</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4">firesData &lt;-<span class="st"> </span><span class="kw">select</span>(ff,ano2000) <span class="co"># the behavioral data</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5">coordRefSys &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +ellps=WGS84&quot;</span>)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">fires2000 &lt;-<span class="st"> </span><span class="kw">SpatialPointsDataFrame</span>(spatialCoords,</a>
<a class="sourceLine" id="cb36-7" data-line-number="7">                                    firesData,</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">                                    <span class="dt">proj4string=</span>coordRefSys)</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">fires2000[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,]</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">bbox</span>(fires2000)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">coordinates</span>(fires2000)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,]</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">summary</span>(fires2000)</a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">mapPT &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Portugal&quot;</span>,<span class="dt">zoom=</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">d4plot &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">cbind</span>(<span class="kw">coordinates</span>(fires2000),<span class="dt">burnt=</span>fires2000<span class="op">$</span>ano2000))</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="kw">ggmap</span>(mapPT) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span><span class="kw">filter</span>(d4plot, burnt<span class="op">==</span><span class="dv">1</span>),<span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat),<span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">library</span>(tm)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">docs &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">DirSource</span>(<span class="st">&quot;Documents&quot;</span>))</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">docs</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">docs[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">content</span>(docs[[<span class="dv">2</span>]])[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">docs &lt;-<span class="st"> </span>docs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">        </span><span class="kw">tm_map</span>(removePunctuation) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">        </span><span class="kw">tm_map</span>(<span class="kw">content_transformer</span>(tolower)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">        </span><span class="kw">tm_map</span>(removeNumbers) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="st">        </span><span class="kw">tm_map</span>(removeWords, <span class="kw">stopwords</span>(<span class="st">&quot;en&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="st">        </span><span class="kw">tm_map</span>(stripWhitespace) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="st">        </span><span class="kw">tm_map</span>(stemDocument)</a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="kw">content</span>(docs[[<span class="dv">2</span>]])[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">weighting=</span>weightTfIdf))</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">data</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">inspect</span>(data[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">findFreqTerms</span>(data,<span class="fl">0.9</span>)</a></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">findAssocs</span>(data,<span class="st">&quot;race&quot;</span>,<span class="fl">0.5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">newData &lt;-<span class="st"> </span><span class="kw">removeSparseTerms</span>(data,<span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb45-2" data-line-number="2">newData</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">as_tibble</span>(<span class="kw">as.matrix</span>(newData))</a></code></pre></div>
</div>
<div id="dimensionality-reduction" class="section level4">
<h4>Dimensionality Reduction</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">prop2sample &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3">rowIDs &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="kw">as.integer</span>(prop2sample<span class="op">*</span><span class="kw">nrow</span>(iris)))</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">iris.sample &lt;-<span class="st"> </span>iris[rowIDs,]</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">prop2sample &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3">rowIDs &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="kw">as.integer</span>(prop2sample<span class="op">*</span><span class="kw">nrow</span>(iris)), <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">iris.sample &lt;-<span class="st"> </span>iris[rowIDs,]</a></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">nrLinesFile &lt;-<span class="st"> </span><span class="cf">function</span>(f) {</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">    <span class="cf">if</span> (.Platform<span class="op">$</span>OS.type <span class="op">==</span><span class="st"> &quot;unix&quot;</span>) </a>
<a class="sourceLine" id="cb49-3" data-line-number="3">        <span class="kw">as.integer</span>(<span class="kw">strsplit</span>(<span class="kw">trimws</span>(<span class="kw">system</span>(<span class="kw">paste</span>(<span class="st">&quot;wc -l&quot;</span>,f),<span class="dt">intern=</span><span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">                            <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]) </a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    <span class="cf">else</span> </a>
<a class="sourceLine" id="cb49-6" data-line-number="6">        <span class="kw">stop</span>(<span class="st">&quot;This function requires unix-based systems&quot;</span>)</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb49-8" data-line-number="8"></a>
<a class="sourceLine" id="cb49-9" data-line-number="9">sampleCSV &lt;-<span class="st"> </span><span class="cf">function</span>(file, percORn, nrLines, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">mxPerc=</span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">    <span class="cf">if</span> (.Platform<span class="op">$</span>OS.type <span class="op">!=</span><span class="st"> &quot;unix&quot;</span>) </a>
<a class="sourceLine" id="cb49-11" data-line-number="11">        <span class="kw">stop</span>(<span class="st">&quot;This function requires unix-based systems&quot;</span>)</a>
<a class="sourceLine" id="cb49-12" data-line-number="12">    <span class="kw">require</span>(readr, <span class="dt">quietly=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb49-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb49-14" data-line-number="14">    <span class="cf">if</span> (<span class="kw">missing</span>(nrLines)) nrLines &lt;-<span class="st"> </span><span class="kw">nrLinesFile</span>(file)</a>
<a class="sourceLine" id="cb49-15" data-line-number="15">    </a>
<a class="sourceLine" id="cb49-16" data-line-number="16">    <span class="cf">if</span> (percORn <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb49-17" data-line-number="17">        <span class="cf">if</span> (percORn <span class="op">&gt;</span><span class="st"> </span>mxPerc) </a>
<a class="sourceLine" id="cb49-18" data-line-number="18">            <span class="kw">stop</span>(<span class="st">&quot;This function is not adequate for that big samples.&quot;</span>)</a>
<a class="sourceLine" id="cb49-19" data-line-number="19">        <span class="cf">else</span> percORn &lt;-<span class="st"> </span><span class="kw">as.integer</span>(percORn<span class="op">*</span>nrLines)</a>
<a class="sourceLine" id="cb49-20" data-line-number="20">    perc &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">2</span><span class="op">*</span>percORn<span class="op">/</span>nrLines, mxPerc)</a>
<a class="sourceLine" id="cb49-21" data-line-number="21">    </a>
<a class="sourceLine" id="cb49-22" data-line-number="22">    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;perl -ne &#39;print if (rand() &lt; &quot;</span>,perc,<span class="st">&quot;)&#39; &quot;</span>,file,</a>
<a class="sourceLine" id="cb49-23" data-line-number="23">                  <span class="st">&quot; &gt; &quot;</span>,file,<span class="st">&quot;.tmp.csv&quot;</span>))</a>
<a class="sourceLine" id="cb49-24" data-line-number="24">    dt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">paste0</span>(file,<span class="st">&quot;.tmp.csv&quot;</span>),<span class="dt">col_names=</span>header, <span class="dt">n_max=</span>percORn)</a>
<a class="sourceLine" id="cb49-25" data-line-number="25">    <span class="kw">file.remove</span>(<span class="kw">paste0</span>(file,<span class="st">&quot;.tmp.csv&quot;</span>))</a>
<a class="sourceLine" id="cb49-26" data-line-number="26">    <span class="cf">if</span> (<span class="kw">nrow</span>(dt) <span class="op">!=</span><span class="st"> </span>percORn) </a>
<a class="sourceLine" id="cb49-27" data-line-number="27">        <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&quot;Expecting&quot;</span>,percORn,<span class="st">&quot;rows, but got&quot;</span>,<span class="kw">nrow</span>(dt)))</a>
<a class="sourceLine" id="cb49-28" data-line-number="28">    dt</a>
<a class="sourceLine" id="cb49-29" data-line-number="29">}</a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">t &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">sampleCSV</span>(<span class="st">&quot;allsensors.csv&quot;</span>, <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="kw">Sys.time</span>()<span class="op">-</span>t</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="kw">nrow</span>(d)</a></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">library</span>(DBI)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">library</span>(RMySQL)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">drv &lt;-<span class="st"> </span><span class="kw">dbDriver</span>(<span class="st">&quot;MySQL&quot;</span>)  <span class="co"># Loading the MySQL driver</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(drv,<span class="dt">dbname=</span><span class="st">&quot;transDB&quot;</span>,  </a>
<a class="sourceLine" id="cb51-5" data-line-number="5">                 <span class="dt">username=</span><span class="st">&quot;myuser&quot;</span>,<span class="dt">password=</span><span class="st">&quot;mypassword&quot;</span>,</a>
<a class="sourceLine" id="cb51-6" data-line-number="6">                 <span class="dt">host=</span><span class="st">&quot;localhost&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">sampleDBMS &lt;-<span class="st"> </span><span class="cf">function</span>(dbConn, tbl, percORn, <span class="dt">mxPerc=</span><span class="fl">0.5</span>) {</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">    nrRecords &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">dbGetQuery</span>(dbConn, <span class="kw">paste</span>(<span class="st">&quot;select count(*) from&quot;</span>,tbl)))</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">    </a>
<a class="sourceLine" id="cb52-4" data-line-number="4">    <span class="cf">if</span> (percORn <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">        <span class="cf">if</span> (percORn <span class="op">&gt;</span><span class="st"> </span>mxPerc) </a>
<a class="sourceLine" id="cb52-6" data-line-number="6">            <span class="kw">stop</span>(<span class="st">&quot;This function is not adequate for that big samples.&quot;</span>)</a>
<a class="sourceLine" id="cb52-7" data-line-number="7">        <span class="cf">else</span> percORn &lt;-<span class="st"> </span><span class="kw">as.integer</span>(percORn<span class="op">*</span>nrRecords)</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">    perc &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">2</span><span class="op">*</span>percORn<span class="op">/</span>nrRecords, mxPerc)</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">    </a>
<a class="sourceLine" id="cb52-10" data-line-number="10">    dt &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dbConn,<span class="kw">paste</span>(<span class="st">&quot;select * from (select * from&quot;</span>,tbl,</a>
<a class="sourceLine" id="cb52-11" data-line-number="11">                                  <span class="st">&quot;where rand() &lt;= &quot;</span>,perc,<span class="st">&quot;) as t limit &quot;</span>,percORn))</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">    <span class="cf">if</span> (<span class="kw">nrow</span>(dt) <span class="op">!=</span><span class="st"> </span>percORn) </a>
<a class="sourceLine" id="cb52-13" data-line-number="13">        <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&quot;Expecting&quot;</span>,percORn,<span class="st">&quot;rows, but got&quot;</span>,<span class="kw">nrow</span>(dt)))</a>
<a class="sourceLine" id="cb52-14" data-line-number="14">    dt</a>
<a class="sourceLine" id="cb52-15" data-line-number="15">}</a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">t1 &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">sampleDBMS</span>(con,<span class="st">&quot;sensor_values&quot;</span>,<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="kw">Sys.time</span>()<span class="op">-</span>t1</a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="kw">nrow</span>(d)</a></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">dbDisconnect</span>(con)  </a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">dbUnloadDriver</span>(drv)</a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">library</span>(CORElearn)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">attrEval</span>(Species <span class="op">~</span><span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;GainRatio&quot;</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="kw">attrEval</span>(Species <span class="op">~</span><span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;InfGain&quot;</span>)</a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="kw">attrEval</span>(Species <span class="op">~</span><span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;Gini&quot;</span>)</a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="kw">attrEval</span>(Species <span class="op">~</span><span class="st"> </span>., iris, <span class="dt">estimator=</span><span class="st">&quot;MDL&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">infoCore</span>(<span class="dt">what=</span><span class="st">&quot;attrEval&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package =</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">attrEval</span>(a1 <span class="op">~</span><span class="st"> </span>., algae[,<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>], <span class="dt">estimator=</span><span class="st">&quot;MSEofMean&quot;</span>)</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="kw">attrEval</span>(a1 <span class="op">~</span><span class="st"> </span>., algae[,<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>], <span class="dt">estimator=</span><span class="st">&quot;RReliefFexpRank&quot;</span>)</a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="kw">infoCore</span>(<span class="dt">what=</span><span class="st">&quot;attrEvalReg&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb58-2" data-line-number="2">pca.data &lt;-<span class="st"> </span>iris[,<span class="op">-</span><span class="dv">5</span>] <span class="co"># each case is described by the first 4 variables</span></a>
<a class="sourceLine" id="cb58-3" data-line-number="3">pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(pca.data)</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"><span class="kw">loadings</span>(pca)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">pca<span class="op">$</span>scores[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</a></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">dim</span>(iris)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">reduced.iris &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pca<span class="op">$</span>scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dt">Species=</span>iris<span class="op">$</span>Species)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"><span class="kw">dim</span>(reduced.iris)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4"><span class="kw">head</span>(reduced.iris)</a></code></pre></div>
<!-- modeling.Rnw -->
</div>
</div>
<div id="modeling" class="section level3">
<h3>Modeling</h3>
<div id="exploratory-data-analysis" class="section level4">
<h4>Exploratory Data Analysis</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">data</span>(algae,<span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw">mean</span>(algae<span class="op">$</span>a1)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="kw">mean</span>(algae<span class="op">$</span>NO3)</a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="kw">mean</span>(algae<span class="op">$</span>NO3, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="kw">median</span>(algae<span class="op">$</span>a3)</a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="kw">median</span>(algae<span class="op">$</span>mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">alg &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(algae)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="kw">summarise</span>(alg, <span class="dt">avgNO3=</span><span class="kw">mean</span>(NO3,<span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">medA1=</span><span class="kw">median</span>(a1))</a>
<a class="sourceLine" id="cb62-4" data-line-number="4"><span class="kw">select</span>(alg, mxPH<span class="op">:</span>Cl) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb62-5" data-line-number="5"><span class="st">    </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="kw">median</span>(.,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">group_by</span>(alg, season, size) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">nObs=</span><span class="kw">n</span>(), <span class="dt">mA7=</span><span class="kw">median</span>(a7)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="st">        </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mA7))</a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">Mode &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>) {</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">  <span class="cf">if</span>(na.rm) x &lt;-<span class="st"> </span>x[<span class="op">!</span><span class="kw">is.na</span>(x)]</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">  ux &lt;-<span class="st"> </span><span class="kw">unique</span>(x)</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">  <span class="kw">return</span>(ux[<span class="kw">which.max</span>(<span class="kw">tabulate</span>(<span class="kw">match</span>(x, ux)))])</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="kw">Mode</span>(algae<span class="op">$</span>mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="kw">Mode</span>(algae<span class="op">$</span>season)</a></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">centralValue</span>(algae<span class="op">$</span>a1)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="kw">centralValue</span>(algae<span class="op">$</span>speed)</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">var</span>(algae<span class="op">$</span>a1)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="kw">sd</span>(algae<span class="op">$</span>Cl, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="kw">IQR</span>(algae<span class="op">$</span>mxPH, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="kw">quantile</span>(algae<span class="op">$</span>a3)</a>
<a class="sourceLine" id="cb66-5" data-line-number="5"><span class="kw">quantile</span>(algae<span class="op">$</span>a3, <span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="kw">range</span>(algae<span class="op">$</span>a1)</a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="kw">max</span>(algae<span class="op">$</span>a5)<span class="op">-</span><span class="kw">min</span>(algae<span class="op">$</span>a5)</a></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">select</span>(alg,a1<span class="op">:</span>a7) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(var))</a></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="kw">group_by</span>(iris,Species) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">qs=</span><span class="kw">quantile</span>(Sepal.Length))</a></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">aggregate</span>(iris<span class="op">$</span>Sepal.Length, <span class="kw">list</span>(<span class="dt">Species=</span>iris<span class="op">$</span>Species), quantile)</a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">aggregate</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data=</span>iris, quantile)</a></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">nasRow &lt;-<span class="st"> </span><span class="kw">apply</span>(algae,<span class="dv">1</span>,<span class="cf">function</span>(r) <span class="kw">sum</span>(<span class="kw">is.na</span>(r)))</a>
<a class="sourceLine" id="cb71-3" data-line-number="3"><span class="kw">cat</span>(<span class="st">&quot;The Algae dataset contains &quot;</span>,<span class="kw">sum</span>(nasRow),<span class="st">&quot; NA values.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb71-4" data-line-number="4"><span class="kw">cat</span>(<span class="st">&quot;There are &quot;</span>,<span class="kw">sum</span>(<span class="op">!</span><span class="kw">complete.cases</span>(algae)),</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">    <span class="st">&quot; rows that have at least one NA value.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">bpRule &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">const=</span><span class="fl">1.5</span>, <span class="dt">positions=</span><span class="ot">FALSE</span>) { </a>
<a class="sourceLine" id="cb72-2" data-line-number="2">    x &lt;-<span class="st"> </span>x[<span class="op">!</span><span class="kw">is.na</span>(x)]</a>
<a class="sourceLine" id="cb72-3" data-line-number="3">    qs &lt;-<span class="st"> </span><span class="kw">quantile</span>(x,<span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</a>
<a class="sourceLine" id="cb72-4" data-line-number="4">    iqr &lt;-<span class="st"> </span>qs[<span class="dv">2</span>]<span class="op">-</span>qs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">    <span class="cf">if</span> (<span class="op">!</span>positions) x[x <span class="op">&lt;</span><span class="st"> </span>qs[<span class="dv">1</span>]<span class="op">-</span>const<span class="op">*</span>iqr <span class="op">|</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span>qs[<span class="dv">2</span>]<span class="op">+</span>const<span class="op">*</span>iqr]</a>
<a class="sourceLine" id="cb72-6" data-line-number="6">    <span class="cf">else</span> <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span>qs[<span class="dv">1</span>]<span class="op">-</span>const<span class="op">*</span>iqr <span class="op">|</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span>qs[<span class="dv">2</span>]<span class="op">+</span>const<span class="op">*</span>iqr)</a>
<a class="sourceLine" id="cb72-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb72-8" data-line-number="8"><span class="kw">bpRule</span>(algae<span class="op">$</span>a1)</a>
<a class="sourceLine" id="cb72-9" data-line-number="9"><span class="kw">bpRule</span>(algae<span class="op">$</span>NO3)</a>
<a class="sourceLine" id="cb72-10" data-line-number="10"><span class="kw">bpRule</span>(algae<span class="op">$</span>NO3, <span class="dt">positions=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="kw">summary</span>(iris)</a></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">library</span>(Hmisc)</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="kw">describe</span>(iris)</a></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">by</span>(algae[,<span class="dv">2</span><span class="op">:</span><span class="dv">5</span>], algae<span class="op">$</span>season,summary)</a></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">pdf</span>(<span class="st">&quot;myplot.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">jpeg</span>(<span class="st">&quot;myplot.jpg&quot;</span>)</a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.1</span>)),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length, <span class="dt">y=</span>Petal.Width, <span class="dt">color=</span>Species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb81-4" data-line-number="4">freqOcc &lt;-<span class="st"> </span><span class="kw">table</span>(algae<span class="op">$</span>season)</a>
<a class="sourceLine" id="cb81-5" data-line-number="5"><span class="kw">barplot</span>(freqOcc,<span class="dt">main=</span><span class="st">&#39;Frequency of the Seasons&#39;</span>)</a>
<a class="sourceLine" id="cb81-6" data-line-number="6"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb81-7" data-line-number="7"><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb82-4" data-line-number="4">freqOcc &lt;-<span class="st"> </span><span class="kw">table</span>(algae<span class="op">$</span>season)</a>
<a class="sourceLine" id="cb82-5" data-line-number="5"></a>
<a class="sourceLine" id="cb82-6" data-line-number="6">gh &lt;-<span class="st"> </span><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-7" data-line-number="7"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>)</a>
<a class="sourceLine" id="cb82-8" data-line-number="8"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb82-9" data-line-number="9">vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),</a>
<a class="sourceLine" id="cb82-10" data-line-number="10">               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb82-11" data-line-number="11"><span class="kw">barplot</span>(freqOcc,<span class="dt">main=</span><span class="st">&#39;Frequency of the Seasons&#39;</span>)</a>
<a class="sourceLine" id="cb82-12" data-line-number="12"><span class="kw">print</span>(gh,<span class="dt">vp=</span>vp)</a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>season)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Frequency of the Seasons&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="kw">hist</span>(iris<span class="op">$</span>Petal.Length,<span class="dt">xlab=</span><span class="st">&#39;Petal Length&#39;</span>)</a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb85-4" data-line-number="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>)</a>
<a class="sourceLine" id="cb85-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb85-6" data-line-number="6">vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),</a>
<a class="sourceLine" id="cb85-7" data-line-number="7">               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb85-8" data-line-number="8"><span class="kw">hist</span>(iris<span class="op">$</span>Petal.Length,<span class="dt">xlab=</span><span class="st">&#39;Petal Length&#39;</span>)</a>
<a class="sourceLine" id="cb85-9" data-line-number="9"><span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="kw">boxplot</span>(iris<span class="op">$</span>Sepal.Width, <span class="dt">ylab=</span><span class="st">&#39;Sepal Width&#39;</span>)</a>
<a class="sourceLine" id="cb86-5" data-line-number="5"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb86-6" data-line-number="6"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(<span class="dv">0</span>), <span class="dt">y=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>())</a></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb87-4" data-line-number="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(<span class="dv">0</span>),<span class="dt">y=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb87-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb87-7" data-line-number="7">vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),</a>
<a class="sourceLine" id="cb87-8" data-line-number="8">               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb87-9" data-line-number="9"><span class="kw">boxplot</span>(iris<span class="op">$</span>Sepal.Width,<span class="dt">ylab=</span><span class="st">&#39;Sepal Width&#39;</span>)</a>
<a class="sourceLine" id="cb87-10" data-line-number="10"><span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</a></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb88-4" data-line-number="4"><span class="kw">boxplot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, iris, <span class="dt">ylab=</span><span class="st">&quot;Sepal.Length&quot;</span>)</a>
<a class="sourceLine" id="cb88-5" data-line-number="5"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb88-6" data-line-number="6"><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Species,<span class="dt">y=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb89-4" data-line-number="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Species,<span class="dt">y=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),</a>
<a class="sourceLine" id="cb89-7" data-line-number="7">               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb89-8" data-line-number="8"><span class="kw">boxplot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, iris, <span class="dt">ylab=</span><span class="st">&quot;Sepal.Length&quot;</span>)</a>
<a class="sourceLine" id="cb89-9" data-line-number="9"><span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</a></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>a1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(size <span class="op">~</span><span class="st"> </span>speed)</a></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="kw">ggplot</span>(algae,<span class="kw">aes</span>(<span class="dt">x=</span>a1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(size <span class="op">~</span><span class="st"> </span>speed)</a></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb92-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb92-4" data-line-number="4"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length,iris<span class="op">$</span>Sepal.Width,</a>
<a class="sourceLine" id="cb92-5" data-line-number="5">     <span class="dt">main=</span><span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>, </a>
<a class="sourceLine" id="cb92-6" data-line-number="6">     <span class="dt">xlab=</span><span class="st">&quot;Sepal Length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal Width&quot;</span>)</a>
<a class="sourceLine" id="cb92-7" data-line-number="7"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb92-8" data-line-number="8"><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length,<span class="dt">y=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-9" data-line-number="9"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-10" data-line-number="10"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb93-4" data-line-number="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris,<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length,<span class="dt">y=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>)</a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-8" data-line-number="8">vp &lt;-<span class="st"> </span><span class="kw">viewport</span>(<span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;npc&quot;</span>),<span class="dt">width=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;npc&quot;</span>),</a>
<a class="sourceLine" id="cb93-9" data-line-number="9">               <span class="dt">just=</span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>,<span class="st">&quot;top&quot;</span>),<span class="dt">y=</span><span class="dv">1</span>,<span class="dt">x=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb93-10" data-line-number="10"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length,iris<span class="op">$</span>Sepal.Width,</a>
<a class="sourceLine" id="cb93-11" data-line-number="11">     <span class="dt">main=</span><span class="st">&quot;Relationship between Sepal Length and Width&quot;</span>, </a>
<a class="sourceLine" id="cb93-12" data-line-number="12">     <span class="dt">xlab=</span><span class="st">&quot;Sepal Length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sepal Width&quot;</span>)</a>
<a class="sourceLine" id="cb93-13" data-line-number="13"><span class="kw">print</span>(g,<span class="dt">vp=</span>vp)</a></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"><span class="kw">plot</span>(algae<span class="op">$</span>a1, algae<span class="op">$</span>a2, <span class="dt">col=</span>algae<span class="op">$</span>season,</a>
<a class="sourceLine" id="cb94-4" data-line-number="4">     <span class="dt">main=</span><span class="st">&quot;Relationship between A1 and A2 by Season&quot;</span>, </a>
<a class="sourceLine" id="cb94-5" data-line-number="5">     <span class="dt">xlab=</span><span class="st">&quot;A1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A2&quot;</span>)</a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae<span class="op">$</span>season),</a>
<a class="sourceLine" id="cb94-7" data-line-number="7">       <span class="dt">col=</span><span class="kw">palette</span>()[<span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(algae<span class="op">$</span>season)],<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb94-8" data-line-number="8"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb94-9" data-line-number="9"><span class="kw">plot</span>(algae<span class="op">$</span>a4, algae<span class="op">$</span>a7, <span class="dt">pch=</span><span class="kw">as.integer</span>(algae<span class="op">$</span>speed), </a>
<a class="sourceLine" id="cb94-10" data-line-number="10">     <span class="dt">main=</span><span class="st">&quot;Relationship between A4 and A7 by River Speed&quot;</span>, </a>
<a class="sourceLine" id="cb94-11" data-line-number="11">     <span class="dt">xlab=</span><span class="st">&quot;A4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A7&quot;</span>)</a>
<a class="sourceLine" id="cb94-12" data-line-number="12"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae<span class="op">$</span>speed),</a>
<a class="sourceLine" id="cb94-13" data-line-number="13">      <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(algae<span class="op">$</span>season))</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="co">## Plot on the left (standard)</span></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="kw">plot</span>(algae<span class="op">$</span>a1, algae<span class="op">$</span>a2, <span class="dt">col=</span>algae<span class="op">$</span>season,</a>
<a class="sourceLine" id="cb95-5" data-line-number="5">     <span class="dt">main=</span><span class="st">&quot;Relationship between A1 and A2 by Season&quot;</span>, </a>
<a class="sourceLine" id="cb95-6" data-line-number="6">     <span class="dt">xlab=</span><span class="st">&quot;A1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A2&quot;</span>)</a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae<span class="op">$</span>season),</a>
<a class="sourceLine" id="cb95-8" data-line-number="8">       <span class="dt">col=</span><span class="kw">palette</span>()[<span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(algae<span class="op">$</span>season)],<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb95-9" data-line-number="9"><span class="co">## Plot on the right (ggplot2)</span></a>
<a class="sourceLine" id="cb95-10" data-line-number="10"><span class="kw">plot</span>(algae<span class="op">$</span>a4, algae<span class="op">$</span>a7, <span class="dt">pch=</span><span class="kw">as.integer</span>(algae<span class="op">$</span>speed), </a>
<a class="sourceLine" id="cb95-11" data-line-number="11">     <span class="dt">main=</span><span class="st">&quot;Relationship between A4 and A7 by River Speed&quot;</span>, </a>
<a class="sourceLine" id="cb95-12" data-line-number="12">     <span class="dt">xlab=</span><span class="st">&quot;A4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;A7&quot;</span>)</a>
<a class="sourceLine" id="cb95-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">levels</span>(algae<span class="op">$</span>speed),</a>
<a class="sourceLine" id="cb95-14" data-line-number="14">      <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(algae<span class="op">$</span>season))</a></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="kw">ggplot</span>(algae, <span class="kw">aes</span>(<span class="dt">x=</span>a1,<span class="dt">y=</span>a2,<span class="dt">color=</span>season)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>season)</a></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="kw">pairs</span>(algae[,<span class="dv">12</span><span class="op">:</span><span class="dv">16</span>])</a></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="kw">pairs</span>(algae[,<span class="dv">12</span><span class="op">:</span><span class="dv">16</span>])</a></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">12</span><span class="op">:</span><span class="dv">16</span>)</a></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">12</span><span class="op">:</span><span class="dv">16</span>)</a></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="kw">ggpairs</span>(algae,<span class="dt">columns=</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">ggparcoord</span>(algae,<span class="dt">columns=</span><span class="dv">12</span><span class="op">:</span><span class="dv">18</span>,<span class="dt">groupColumn=</span><span class="st">&quot;season&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="kw">ggparcoord</span>(algae,<span class="dt">columns=</span><span class="dv">12</span><span class="op">:</span><span class="dv">18</span>,<span class="dt">groupColumn=</span><span class="st">&quot;season&quot;</span>)</a></code></pre></div>
</div>
<div id="dependency-modeling-using-association-rules" class="section level4">
<h4>Dependency Modeling using Association Rules</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">library</span>(arules)</a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb105-3" data-line-number="3"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb105-4" data-line-number="4">b &lt;-<span class="st"> </span>Boston</a>
<a class="sourceLine" id="cb105-5" data-line-number="5">b<span class="op">$</span>chas &lt;-<span class="st"> </span><span class="kw">factor</span>(b<span class="op">$</span>chas,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;river&quot;</span>,<span class="st">&quot;noriver&quot;</span>))</a>
<a class="sourceLine" id="cb105-6" data-line-number="6">b<span class="op">$</span>rad &lt;-<span class="st"> </span><span class="kw">factor</span>(b<span class="op">$</span>rad)</a>
<a class="sourceLine" id="cb105-7" data-line-number="7">b<span class="op">$</span>black &lt;-<span class="st"> </span><span class="kw">cut</span>(b<span class="op">$</span>black,<span class="dt">breaks=</span><span class="dv">4</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;&gt;31.5%&quot;</span>,<span class="st">&quot;18.5-31.5%&quot;</span>,<span class="st">&quot;8-18.5%&quot;</span>,<span class="st">&quot;&lt;8%&quot;</span>))</a>
<a class="sourceLine" id="cb105-8" data-line-number="8">discr &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">cut</span>(x,<span class="dt">breaks=</span><span class="dv">4</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medLow&quot;</span>,<span class="st">&quot;medHigh&quot;</span>,<span class="st">&quot;high&quot;</span>))</a>
<a class="sourceLine" id="cb105-9" data-line-number="9">b &lt;-<span class="st"> </span><span class="kw">select</span>(b,<span class="op">-</span><span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;chas&quot;</span>,<span class="st">&quot;rad&quot;</span>,<span class="st">&quot;black&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-10" data-line-number="10"><span class="st">     </span><span class="kw">mutate_each</span>(<span class="kw">funs</span>(discr)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-11" data-line-number="11"><span class="st">     </span><span class="kw">bind_cols</span>(<span class="kw">select</span>(b,<span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;chas&quot;</span>,<span class="st">&quot;rad&quot;</span>,<span class="st">&quot;black&quot;</span>))))</a>
<a class="sourceLine" id="cb105-12" data-line-number="12">b &lt;-<span class="st"> </span><span class="kw">as</span>(b,<span class="st">&quot;transactions&quot;</span>)</a>
<a class="sourceLine" id="cb105-13" data-line-number="13">b</a></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">summary</span>(b)</a></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">itemFrequencyPlot</span>(b, <span class="dt">support=</span><span class="fl">0.3</span>,<span class="dt">cex.names=</span><span class="fl">0.8</span>)</a></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">itemFrequencyPlot</span>(b, <span class="dt">support=</span><span class="fl">0.3</span>,<span class="dt">cex.names=</span><span class="fl">0.8</span>)</a></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">ars &lt;-<span class="st"> </span><span class="kw">apriori</span>(b, <span class="dt">parameter=</span><span class="kw">list</span>(<span class="dt">support=</span><span class="fl">0.025</span>, <span class="dt">confidence=</span><span class="fl">0.75</span>))</a>
<a class="sourceLine" id="cb109-2" data-line-number="2">ars</a></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="kw">table</span>(<span class="kw">discr</span>(Boston<span class="op">$</span>medv))</a></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs <span class="op">%in%</span><span class="st"> &quot;medv=high&quot;</span>),<span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs <span class="op">%in%</span><span class="st"> &quot;medv=low&quot;</span>),<span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">inspect</span>(<span class="kw">head</span>(<span class="kw">subset</span>(ars, <span class="dt">subset=</span>lhs <span class="op">%in%</span><span class="st"> &quot;nox=high&quot;</span> <span class="op">|</span><span class="st"> </span>rhs <span class="op">%in%</span><span class="st"> &quot;nox=high&quot;</span>),</a>
<a class="sourceLine" id="cb113-2" data-line-number="2">             <span class="dv">5</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw">library</span>(arulesViz)</a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="kw">plot</span>(ars)</a></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">library</span>(arulesViz)</a>
<a class="sourceLine" id="cb115-2" data-line-number="2"><span class="kw">plot</span>(ars)</a></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars,</a>
<a class="sourceLine" id="cb116-2" data-line-number="2">               <span class="dt">subset=</span>rhs <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;medv=high&quot;</span>,<span class="st">&quot;medv=medHigh&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>confidence<span class="op">&gt;</span><span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb116-3" data-line-number="3"><span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;matrix&quot;</span>, <span class="dt">measure=</span><span class="st">&quot;lift&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars,<span class="dt">subset=</span>rhs <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;medv=high&quot;</span>,<span class="st">&quot;medv=medHigh&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>confidence<span class="op">&gt;</span><span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;matrix&quot;</span>, <span class="dt">measure=</span><span class="st">&quot;lift&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">somerules &lt;-<span class="st"> </span><span class="kw">subset</span>(ars, <span class="dt">subset=</span>rhs <span class="op">%in%</span><span class="st"> &quot;medv=high&quot;</span> <span class="op">&amp;</span><span class="st"> </span>confidence <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="kw">plot</span>(somerules, <span class="dt">method=</span><span class="st">&quot;graph&quot;</span>, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&quot;itemsets&quot;</span>))</a></code></pre></div>
</div>
<div id="clustering" class="section level4">
<h4>Clustering</h4>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">randDat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>), <span class="dt">nrow=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="kw">dist</span>(randDat) <span class="co"># Euclidean distance (default)</span></a>
<a class="sourceLine" id="cb119-4" data-line-number="4"><span class="kw">dist</span>(randDat, <span class="dt">method=</span><span class="st">&quot;manhattan&quot;</span>)</a>
<a class="sourceLine" id="cb119-5" data-line-number="5"><span class="kw">dist</span>(randDat, <span class="dt">method=</span><span class="st">&quot;minkowski&quot;</span>, <span class="dt">p=</span><span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>) <span class="co"># setting a seed for the random number generator</span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb120-3" data-line-number="3">ir3 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris[,<span class="op">-</span><span class="dv">5</span>], <span class="dt">centers=</span><span class="dv">3</span>, <span class="dt">iter.max=</span><span class="dv">200</span>) <span class="co"># not using Species info.</span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4">ir3</a></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">table</span>(ir3<span class="op">$</span>cluster, iris<span class="op">$</span>Species)</a>
<a class="sourceLine" id="cb121-2" data-line-number="2">cm &lt;-<span class="st"> </span><span class="kw">table</span>(ir3<span class="op">$</span>cluster, iris<span class="op">$</span>Species)</a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm)</a></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="kw">library</span>(cluster)</a>
<a class="sourceLine" id="cb122-2" data-line-number="2">s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(ir3<span class="op">$</span>cluster, <span class="kw">dist</span>(iris[,<span class="op">-</span><span class="dv">5</span>]))</a></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="kw">plot</span>(s)</a></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw">plot</span>(s)</a></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb125-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">dist</span>(iris[,<span class="op">-</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb125-3" data-line-number="3">avgS &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb125-4" data-line-number="4"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb125-5" data-line-number="5">   cl &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris[,<span class="op">-</span><span class="dv">5</span>],<span class="dt">centers=</span>k,<span class="dt">iter.max=</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb125-6" data-line-number="6">   s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(cl<span class="op">$</span>cluster,d)</a>
<a class="sourceLine" id="cb125-7" data-line-number="7">   avgS &lt;-<span class="st"> </span><span class="kw">c</span>(avgS,<span class="kw">mean</span>(s[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb125-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb125-9" data-line-number="9"><span class="kw">data.frame</span>(<span class="dt">nClus=</span><span class="dv">2</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">Silh=</span>avgS)</a></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw">library</span>(cluster)</a>
<a class="sourceLine" id="cb126-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb126-3" data-line-number="3">pc &lt;-<span class="st"> </span><span class="kw">pam</span>(iris[,<span class="op">-</span><span class="dv">5</span>],<span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb126-4" data-line-number="4">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(pc<span class="op">$</span>clustering, iris<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb126-5" data-line-number="5"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))</a>
<a class="sourceLine" id="cb126-6" data-line-number="6">pc<span class="op">$</span>silinfo<span class="op">$</span>avg.width</a></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">library</span>(fpc)</a>
<a class="sourceLine" id="cb127-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb127-3" data-line-number="3">sol &lt;-<span class="st"> </span><span class="kw">pamk</span>(iris[,<span class="op">-</span><span class="dv">5</span>], <span class="dt">krange=</span><span class="dv">2</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">criterion=</span><span class="st">&quot;asw&quot;</span>, <span class="dt">usepam=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb127-4" data-line-number="4">sol</a></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">scale</span>(iris[,<span class="op">-</span><span class="dv">5</span>]))</a>
<a class="sourceLine" id="cb128-2" data-line-number="2">h &lt;-<span class="st"> </span><span class="kw">hclust</span>(d)</a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">plot</span>(h,<span class="dt">hang=</span><span class="op">-</span><span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="kw">plot</span>(h,<span class="dt">hang=</span><span class="op">-</span><span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">clus3 &lt;-<span class="st"> </span><span class="kw">cutree</span>(h, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb131-2" data-line-number="2">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(clus3, iris<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb131-3" data-line-number="3"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))</a></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">plot</span>(h,<span class="dt">hang=</span><span class="op">-</span><span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="kw">rect.hclust</span>(h,<span class="dt">k=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">plot</span>(h,<span class="dt">hang=</span><span class="op">-</span><span class="fl">0.1</span>,<span class="dt">labels=</span>iris[[<span class="st">&quot;Species&quot;</span>]],<span class="dt">cex=</span><span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb133-2" data-line-number="2"><span class="kw">rect.hclust</span>(h,<span class="dt">k=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb134-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">scale</span>(iris[,<span class="op">-</span><span class="dv">5</span>]))</a>
<a class="sourceLine" id="cb134-3" data-line-number="3">methds &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;complete&#39;</span>,<span class="st">&#39;single&#39;</span>,<span class="st">&#39;average&#39;</span>)</a>
<a class="sourceLine" id="cb134-4" data-line-number="4">avgS &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">ncol=</span><span class="dv">3</span>,<span class="dt">nrow=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb134-5" data-line-number="5">               <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>,methds))</a>
<a class="sourceLine" id="cb134-6" data-line-number="6"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>) </a>
<a class="sourceLine" id="cb134-7" data-line-number="7">  <span class="cf">for</span>(m <span class="cf">in</span> <span class="kw">seq_along</span>(methds)) {</a>
<a class="sourceLine" id="cb134-8" data-line-number="8">    h &lt;-<span class="st"> </span><span class="kw">hclust</span>(d,<span class="dt">meth=</span>methds[m])</a>
<a class="sourceLine" id="cb134-9" data-line-number="9">    c &lt;-<span class="st"> </span><span class="kw">cutree</span>(h,k)</a>
<a class="sourceLine" id="cb134-10" data-line-number="10">    s &lt;-<span class="st"> </span><span class="kw">silhouette</span>(c,d)</a>
<a class="sourceLine" id="cb134-11" data-line-number="11">    avgS[k<span class="dv">-1</span>,m] &lt;-<span class="st"> </span><span class="kw">mean</span>(s[,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb134-12" data-line-number="12">  }</a>
<a class="sourceLine" id="cb134-13" data-line-number="13">avgS</a></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">di &lt;-<span class="st"> </span><span class="kw">diana</span>(iris[,<span class="op">-</span><span class="dv">5</span>], <span class="dt">metric=</span><span class="st">&#39;euclidean&#39;</span>, <span class="dt">stand=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb135-2" data-line-number="2">di3 &lt;-<span class="st"> </span><span class="kw">cutree</span>(di, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb135-3" data-line-number="3">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(di3, iris<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb135-4" data-line-number="4"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))</a></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">cm &lt;-<span class="st"> </span>cm[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb136-2" data-line-number="2"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))</a></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1"><span class="kw">library</span>(fpc)</a>
<a class="sourceLine" id="cb137-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">scale</span>(iris[,<span class="op">-</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb137-3" data-line-number="3">db &lt;-<span class="st"> </span><span class="kw">dbscan</span>(d, <span class="dt">eps=</span><span class="fl">0.9</span>, <span class="dt">MinPts=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb137-4" data-line-number="4">db</a>
<a class="sourceLine" id="cb137-5" data-line-number="5"><span class="kw">table</span>(db<span class="op">$</span>cluster,iris<span class="op">$</span>Species)</a></code></pre></div>
</div>
<div id="anomaly-detection" class="section level4">
<h4>Anomaly Detection</h4>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">grubbs.outliers &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">p.thresh=</span><span class="fl">0.05</span>) {</a>
<a class="sourceLine" id="cb138-2" data-line-number="2">    <span class="kw">require</span>(outliers, <span class="dt">quietly=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb138-3" data-line-number="3">    x &lt;-<span class="st"> </span>x[<span class="op">!</span><span class="kw">is.na</span>(x)]</a>
<a class="sourceLine" id="cb138-4" data-line-number="4">    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb138-5" data-line-number="5">    zs &lt;-<span class="st"> </span><span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb138-6" data-line-number="6">    outs &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sapply</span>(zs, <span class="cf">function</span>(z) <span class="kw">pgrubbs</span>(z, n, <span class="dt">type=</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb138-7" data-line-number="7">    posOuts &lt;-<span class="st"> </span><span class="kw">which</span>(outs <span class="op">&lt;=</span><span class="st"> </span>p.thresh)</a>
<a class="sourceLine" id="cb138-8" data-line-number="8">    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">zs=</span>zs, </a>
<a class="sourceLine" id="cb138-9" data-line-number="9">                <span class="dt">pvals=</span>outs, </a>
<a class="sourceLine" id="cb138-10" data-line-number="10">                <span class="dt">outliers=</span>x[posOuts],</a>
<a class="sourceLine" id="cb138-11" data-line-number="11">                <span class="dt">positions=</span>posOuts))</a>
<a class="sourceLine" id="cb138-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb138-13" data-line-number="13"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb138-14" data-line-number="14"><span class="kw">grubbs.outliers</span>(algae<span class="op">$</span>a2)<span class="op">$</span>outliers</a></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1"><span class="kw">data</span>(algae, <span class="dt">package=</span><span class="st">&quot;DMwR2&quot;</span>)</a>
<a class="sourceLine" id="cb139-2" data-line-number="2"><span class="kw">table</span>(algae<span class="op">$</span>season)<span class="op">/</span><span class="kw">length</span>(algae<span class="op">$</span>season)</a></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">dbscan.outliers &lt;-<span class="st"> </span><span class="cf">function</span>(data, ...) {</a>
<a class="sourceLine" id="cb140-2" data-line-number="2">    <span class="kw">require</span>(fpc, <span class="dt">quietly=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb140-3" data-line-number="3">    cl &lt;-<span class="st"> </span><span class="kw">dbscan</span>(data, ...)</a>
<a class="sourceLine" id="cb140-4" data-line-number="4">    posOuts &lt;-<span class="st"> </span><span class="kw">which</span>(cl<span class="op">$</span>cluster <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb140-5" data-line-number="5">    <span class="kw">list</span>(<span class="dt">positions =</span> posOuts,</a>
<a class="sourceLine" id="cb140-6" data-line-number="6">         <span class="dt">outliers =</span> data[posOuts,], </a>
<a class="sourceLine" id="cb140-7" data-line-number="7">         <span class="dt">dbscanResults =</span> cl)</a>
<a class="sourceLine" id="cb140-8" data-line-number="8">}</a></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="kw">library</span>(forcats)</a>
<a class="sourceLine" id="cb141-3" data-line-number="3"><span class="kw">data</span>(Glass, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)</a>
<a class="sourceLine" id="cb141-4" data-line-number="4"><span class="kw">count</span>(Glass,Type)  <span class="co"># a dplyr  alternative to &quot;table(Glass$Type)&quot;</span></a>
<a class="sourceLine" id="cb141-5" data-line-number="5">g &lt;-<span class="st"> </span><span class="kw">mutate</span>(Glass,</a>
<a class="sourceLine" id="cb141-6" data-line-number="6">            <span class="dt">Type=</span><span class="kw">fct_collapse</span>(Type,</a>
<a class="sourceLine" id="cb141-7" data-line-number="7">                              <span class="dt">rare   =</span> <span class="kw">as.character</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)),</a>
<a class="sourceLine" id="cb141-8" data-line-number="8">                              <span class="dt">normal =</span> <span class="kw">as.character</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>))</a>
<a class="sourceLine" id="cb141-9" data-line-number="9">                              )</a>
<a class="sourceLine" id="cb141-10" data-line-number="10">            )</a>
<a class="sourceLine" id="cb141-11" data-line-number="11">g <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(Type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">prop=</span><span class="dv">100</span><span class="op">*</span>n<span class="op">/</span><span class="kw">nrow</span>(g))</a></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">outs &lt;-<span class="st"> </span><span class="kw">dbscan.outliers</span>(g[,<span class="op">-</span><span class="dv">10</span>], <span class="dt">eps=</span><span class="dv">1</span>, <span class="dt">scale=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="kw">head</span>(outs<span class="op">$</span>outliers)</a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="kw">nrow</span>(outs<span class="op">$</span>outliers)</a>
<a class="sourceLine" id="cb142-4" data-line-number="4"><span class="kw">slice</span>(g, outs<span class="op">$</span>positions) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">count</span>(Type)</a>
<a class="sourceLine" id="cb142-5" data-line-number="5"><span class="kw">count</span>(g, Type)</a></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb143-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb143-3" data-line-number="3">og &lt;-<span class="st"> </span><span class="kw">outliers.ranking</span>(<span class="kw">select</span>(g, <span class="op">-</span>Type))</a>
<a class="sourceLine" id="cb143-4" data-line-number="4"><span class="kw">slice</span>(g, og<span class="op">$</span>rank.outliers[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">count</span>(Type)</a></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb144-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb144-3" data-line-number="3">lof.scores &lt;-<span class="st"> </span><span class="kw">lofactor</span>(<span class="kw">select</span>(g, <span class="op">-</span>Type),<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb144-4" data-line-number="4"><span class="kw">slice</span>(g, <span class="kw">order</span>(lof.scores,<span class="dt">decreasing=</span><span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">count</span>(Type)</a></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="kw">library</span>(UBL)</a>
<a class="sourceLine" id="cb145-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb145-3" data-line-number="3"><span class="kw">count</span>(g,Type)</a>
<a class="sourceLine" id="cb145-4" data-line-number="4"><span class="co">## Undersampling the largest class</span></a>
<a class="sourceLine" id="cb145-5" data-line-number="5">newg &lt;-<span class="st"> </span><span class="kw">RandUnderClassif</span>(Type <span class="op">~</span><span class="st"> </span>., g)</a>
<a class="sourceLine" id="cb145-6" data-line-number="6"><span class="kw">count</span>(newg,Type)</a>
<a class="sourceLine" id="cb145-7" data-line-number="7"><span class="co">## Now specifying the degree of undersampling by hand</span></a>
<a class="sourceLine" id="cb145-8" data-line-number="8">newg2 &lt;-<span class="st"> </span><span class="kw">RandUnderClassif</span>(Type <span class="op">~</span><span class="st"> </span>., g, <span class="kw">list</span>(<span class="dt">normal=</span><span class="fl">0.4</span>, <span class="dt">rare=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb145-9" data-line-number="9"><span class="kw">count</span>(newg2,Type)</a>
<a class="sourceLine" id="cb145-10" data-line-number="10"><span class="co">## Oversampling the minority class</span></a>
<a class="sourceLine" id="cb145-11" data-line-number="11">newg3 &lt;-<span class="st"> </span><span class="kw">RandOverClassif</span>(Type <span class="op">~</span><span class="st"> </span>.,g)</a>
<a class="sourceLine" id="cb145-12" data-line-number="12"><span class="kw">count</span>(newg3,Type)</a></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw">library</span>(e1071)</a>
<a class="sourceLine" id="cb146-2" data-line-number="2">trainD &lt;-<span class="st"> </span><span class="kw">filter</span>(g, Type <span class="op">==</span><span class="st"> &quot;normal&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Type) </a>
<a class="sourceLine" id="cb146-3" data-line-number="3">s &lt;-<span class="st"> </span><span class="kw">svm</span>(trainD, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">type=</span><span class="st">&quot;one-classification&quot;</span>, <span class="dt">nu=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb146-4" data-line-number="4">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(g<span class="op">$</span>Type, <span class="kw">predict</span>(s,<span class="kw">select</span>(g, <span class="op">-</span>Type))))</a></code></pre></div>
</div>
<div id="predictive-analytics" class="section level4">
<h4>Predictive Analytics</h4>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb147-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb147-4" data-line-number="4">ct1 &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species <span class="op">~</span><span class="st"> </span>., iris)</a>
<a class="sourceLine" id="cb147-5" data-line-number="5">ct2 &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species <span class="op">~</span><span class="st"> </span>., iris, <span class="dt">se=</span><span class="dv">0</span>)</a></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="kw">prp</span>(ct1, <span class="dt">type=</span><span class="dv">0</span>, <span class="dt">extra=</span><span class="dv">101</span>)  <span class="co"># left tree</span></a>
<a class="sourceLine" id="cb148-3" data-line-number="3"><span class="kw">prp</span>(ct2, <span class="dt">type=</span><span class="dv">0</span>, <span class="dt">extra=</span><span class="dv">101</span>)  <span class="co"># right tree</span></a></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb149-2" data-line-number="2"><span class="kw">par</span>( <span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) )</a>
<a class="sourceLine" id="cb149-3" data-line-number="3"><span class="kw">prp</span>(ct1,<span class="dt">type=</span><span class="dv">0</span>,<span class="dt">extra=</span><span class="dv">101</span>) </a>
<a class="sourceLine" id="cb149-4" data-line-number="4"><span class="kw">prp</span>(ct2,<span class="dt">type=</span><span class="dv">0</span>,<span class="dt">extra=</span><span class="dv">101</span>)</a>
<a class="sourceLine" id="cb149-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb150-2" data-line-number="2">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris),<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb150-3" data-line-number="3">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb150-4" data-line-number="4">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb150-5" data-line-number="5">ct &lt;-<span class="st"> </span><span class="kw">rpartXse</span>(Species <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">se=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb150-6" data-line-number="6">ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(ct, ts)</a>
<a class="sourceLine" id="cb150-7" data-line-number="7"><span class="kw">head</span>(ps1)</a>
<a class="sourceLine" id="cb150-8" data-line-number="8">ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(ct, ts, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)</a>
<a class="sourceLine" id="cb150-9" data-line-number="9"><span class="kw">head</span>(ps2)</a>
<a class="sourceLine" id="cb150-10" data-line-number="10">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps2, ts<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb150-11" data-line-number="11"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="kw">library</span>(e1071)</a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb151-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb151-4" data-line-number="4">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb151-5" data-line-number="5">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb151-6" data-line-number="6">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb151-7" data-line-number="7">s &lt;-<span class="st"> </span><span class="kw">svm</span>(Species <span class="op">~</span><span class="st"> </span>., tr)</a>
<a class="sourceLine" id="cb151-8" data-line-number="8">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(s, ts)</a>
<a class="sourceLine" id="cb151-9" data-line-number="9">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb151-10" data-line-number="10"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">s2 &lt;-<span class="st"> </span><span class="kw">svm</span>(Species <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">cost=</span><span class="dv">10</span>, <span class="dt">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="dt">degree=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb152-2" data-line-number="2">ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(s2, ts)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3">(cm2 &lt;-<span class="st"> </span><span class="kw">table</span>(ps2, ts<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb152-4" data-line-number="4"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm2))<span class="op">/</span><span class="kw">sum</span>(cm2))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)</a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb153-3" data-line-number="3">sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Boston),<span class="dv">354</span>)</a>
<a class="sourceLine" id="cb153-4" data-line-number="4">tr &lt;-<span class="st"> </span>Boston[sp,]</a>
<a class="sourceLine" id="cb153-5" data-line-number="5">ts &lt;-<span class="st"> </span>Boston[<span class="op">-</span>sp,]</a>
<a class="sourceLine" id="cb153-6" data-line-number="6">s1 &lt;-<span class="st"> </span><span class="kw">svm</span>(medv <span class="op">~</span><span class="st"> </span>., tr)</a>
<a class="sourceLine" id="cb153-7" data-line-number="7">ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(s1, ts)</a>
<a class="sourceLine" id="cb153-8" data-line-number="8"><span class="kw">mean</span>(<span class="kw">abs</span>(ps1<span class="op">-</span>ts<span class="op">$</span>medv))</a>
<a class="sourceLine" id="cb153-9" data-line-number="9">s2 &lt;-<span class="st"> </span><span class="kw">svm</span>(medv <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="dt">cost=</span><span class="dv">10</span>, <span class="dt">epsilon=</span><span class="fl">0.02</span>, <span class="dt">gamma=</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb153-10" data-line-number="10">ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(s2, ts)</a>
<a class="sourceLine" id="cb153-11" data-line-number="11"><span class="kw">mean</span>(<span class="kw">abs</span>(ps2<span class="op">-</span>ts<span class="op">$</span>medv))</a></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw">library</span>(nnet)</a>
<a class="sourceLine" id="cb154-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb154-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb154-4" data-line-number="4">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb154-5" data-line-number="5">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb154-6" data-line-number="6">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb154-7" data-line-number="7">n &lt;-<span class="st"> </span><span class="kw">nnet</span>(Species <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">size=</span><span class="dv">6</span> ,<span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">maxit=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb154-8" data-line-number="8">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(n, ts, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)</a>
<a class="sourceLine" id="cb154-9" data-line-number="9">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb154-10" data-line-number="10"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)</a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb155-3" data-line-number="3">sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Boston),<span class="dv">354</span>)</a>
<a class="sourceLine" id="cb155-4" data-line-number="4">tr &lt;-<span class="st"> </span>Boston[sp,]</a>
<a class="sourceLine" id="cb155-5" data-line-number="5">ts &lt;-<span class="st"> </span>Boston[<span class="op">-</span>sp,]</a>
<a class="sourceLine" id="cb155-6" data-line-number="6">nr &lt;-<span class="st"> </span><span class="kw">nnet</span>(medv <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">linout=</span><span class="ot">TRUE</span>, <span class="dt">trace=</span><span class="ot">FALSE</span>, <span class="dt">size=</span><span class="dv">6</span>, <span class="dt">decay=</span><span class="fl">0.01</span>, <span class="dt">maxit=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb155-7" data-line-number="7">psnr &lt;-<span class="st"> </span><span class="kw">predict</span>(nr, ts)</a>
<a class="sourceLine" id="cb155-8" data-line-number="8"><span class="kw">mean</span>(<span class="kw">abs</span>(psnr<span class="op">-</span>ts<span class="op">$</span>medv))</a></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb156-2" data-line-number="2"><span class="kw">library</span>(NeuralNetTools)</a>
<a class="sourceLine" id="cb156-3" data-line-number="3"><span class="co">## Feature importance (left graph)</span></a>
<a class="sourceLine" id="cb156-4" data-line-number="4"><span class="kw">garson</span>(nr) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb156-5" data-line-number="5"><span class="co">## Network diagram (rigth graph)</span></a>
<a class="sourceLine" id="cb156-6" data-line-number="6"><span class="kw">plotnet</span>(nr)    </a></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="kw">library</span>(h2o)</a>
<a class="sourceLine" id="cb157-2" data-line-number="2">h2oInstance &lt;-<span class="st"> </span><span class="kw">h2o.init</span>(<span class="dt">ip=</span><span class="st">&quot;localhost&quot;</span>)  <span class="co"># start H2O instance locally</span></a></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb158-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb158-3" data-line-number="3">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb158-4" data-line-number="4">trH  &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(iris[rndSample, ],<span class="st">&quot;trH&quot;</span>)</a>
<a class="sourceLine" id="cb158-5" data-line-number="5">tsH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(iris[<span class="op">-</span>rndSample, ],<span class="st">&quot;tsH&quot;</span>)</a>
<a class="sourceLine" id="cb158-6" data-line-number="6">mdl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">y=</span><span class="dv">5</span>, <span class="dt">training_frame=</span>trH)</a>
<a class="sourceLine" id="cb158-7" data-line-number="7">preds &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(mdl,tsH)[,<span class="st">&quot;predict&quot;</span>]</a></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.vector</span>(preds), <span class="kw">as.vector</span>(tsH<span class="op">$</span>Species)))</a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))</a></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw">library</span>(h2o)</a>
<a class="sourceLine" id="cb160-2" data-line-number="2">h2oInstance &lt;-<span class="st"> </span><span class="kw">h2o.init</span>(<span class="dt">ip=</span><span class="st">&quot;localhost&quot;</span>) <span class="co"># start H2O instance locally</span></a>
<a class="sourceLine" id="cb160-3" data-line-number="3"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb160-4" data-line-number="4">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Boston), <span class="dv">354</span>)</a>
<a class="sourceLine" id="cb160-5" data-line-number="5">trH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(Boston[rndSample, ],<span class="st">&quot;trH&quot;</span>)</a>
<a class="sourceLine" id="cb160-6" data-line-number="6">tsH &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(Boston[<span class="op">-</span>rndSample, ],<span class="st">&quot;tsH&quot;</span>)</a>
<a class="sourceLine" id="cb160-7" data-line-number="7">mdl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">training_frame=</span>trH, </a>
<a class="sourceLine" id="cb160-8" data-line-number="8">                        <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>, <span class="dv">100</span>), <span class="dt">epochs=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb160-9" data-line-number="9">preds &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">h2o.predict</span>(mdl,tsH))</a></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="kw">mean</span>(<span class="kw">abs</span>(preds<span class="op">-</span><span class="kw">as.vector</span>(tsH<span class="op">$</span>medv)))</a></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="kw">library</span>(adabag)</a>
<a class="sourceLine" id="cb162-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb162-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb162-4" data-line-number="4">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb162-5" data-line-number="5">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb162-6" data-line-number="6">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb162-7" data-line-number="7"> m &lt;-<span class="st"> </span><span class="kw">bagging</span>(Species <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">mfinal=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb162-8" data-line-number="8">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m,ts)</a>
<a class="sourceLine" id="cb162-9" data-line-number="9"><span class="kw">names</span>(ps)</a>
<a class="sourceLine" id="cb162-10" data-line-number="10">ps<span class="op">$</span>confusion</a>
<a class="sourceLine" id="cb162-11" data-line-number="11">ps<span class="op">$</span>error<span class="op">*</span><span class="dv">100</span> <span class="co"># percentage of errors</span></a></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">library</span>(ipred)</a>
<a class="sourceLine" id="cb163-2" data-line-number="2"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)</a>
<a class="sourceLine" id="cb163-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb163-4" data-line-number="4">sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Boston),<span class="dv">354</span>)</a>
<a class="sourceLine" id="cb163-5" data-line-number="5">tr &lt;-<span class="st"> </span>Boston[sp,]</a>
<a class="sourceLine" id="cb163-6" data-line-number="6">ts &lt;-<span class="st"> </span>Boston[<span class="op">-</span>sp,]</a>
<a class="sourceLine" id="cb163-7" data-line-number="7">m &lt;-<span class="st"> </span><span class="kw">bagging</span>(medv <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">nbagg=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb163-8" data-line-number="8">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts)</a>
<a class="sourceLine" id="cb163-9" data-line-number="9"><span class="kw">mean</span>(<span class="kw">abs</span>(ps<span class="op">-</span>ts<span class="op">$</span>medv))</a></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="kw">library</span>(randomForest)</a>
<a class="sourceLine" id="cb164-2" data-line-number="2"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb164-3" data-line-number="3"><span class="kw">data</span>(BreastCancer, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)</a>
<a class="sourceLine" id="cb164-4" data-line-number="4">bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">knnImputation</span>(BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">11</span>)]), <span class="co"># column 1 is an ID</span></a>
<a class="sourceLine" id="cb164-5" data-line-number="5">            <span class="dt">Class=</span>BreastCancer<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb164-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb164-7" data-line-number="7">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(bc), <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb164-8" data-line-number="8">tr &lt;-<span class="st"> </span>bc[rndSample, ] </a>
<a class="sourceLine" id="cb164-9" data-line-number="9">ts &lt;-<span class="st"> </span>bc[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb164-10" data-line-number="10">m &lt;-<span class="st"> </span><span class="kw">randomForest</span>(Class <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">ntree=</span><span class="dv">750</span>)</a>
<a class="sourceLine" id="cb164-11" data-line-number="11">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts)</a>
<a class="sourceLine" id="cb164-12" data-line-number="12">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts<span class="op">$</span>Class))</a>
<a class="sourceLine" id="cb164-13" data-line-number="13"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1"><span class="kw">library</span>(adabag)</a>
<a class="sourceLine" id="cb165-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb165-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb165-4" data-line-number="4">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb165-5" data-line-number="5">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb165-6" data-line-number="6">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb165-7" data-line-number="7">m1 &lt;-<span class="st"> </span><span class="kw">boosting</span>(Species <span class="op">~</span><span class="st"> </span>., tr,  <span class="dt">mfinal=</span><span class="dv">500</span>) <span class="co"># AdaBoost.M1</span></a>
<a class="sourceLine" id="cb165-8" data-line-number="8">ps1 &lt;-<span class="st"> </span><span class="kw">predict</span>(m1,ts)</a>
<a class="sourceLine" id="cb165-9" data-line-number="9">ps1<span class="op">$</span>confusion</a>
<a class="sourceLine" id="cb165-10" data-line-number="10">ps1<span class="op">$</span>error<span class="op">*</span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb165-11" data-line-number="11">m2 &lt;-<span class="st"> </span><span class="kw">boosting</span>(Species <span class="op">~</span><span class="st"> </span>., tr, <span class="dt">coeflearn=</span><span class="st">&quot;Zhu&quot;</span>, <span class="dt">mfinal=</span><span class="dv">500</span>) <span class="co"># SAMME</span></a>
<a class="sourceLine" id="cb165-12" data-line-number="12">ps2 &lt;-<span class="st"> </span><span class="kw">predict</span>(m2,ts)</a>
<a class="sourceLine" id="cb165-13" data-line-number="13">ps2<span class="op">$</span>confusion</a>
<a class="sourceLine" id="cb165-14" data-line-number="14">ps2<span class="op">$</span>error<span class="op">*</span><span class="dv">100</span> </a></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="kw">library</span>(gbm)</a>
<a class="sourceLine" id="cb166-2" data-line-number="2"><span class="kw">data</span>(Boston,<span class="dt">package=</span><span class="st">&#39;MASS&#39;</span>)</a>
<a class="sourceLine" id="cb166-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb166-4" data-line-number="4">sp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Boston),<span class="dv">354</span>)</a>
<a class="sourceLine" id="cb166-5" data-line-number="5">tr &lt;-<span class="st"> </span>Boston[sp,]</a>
<a class="sourceLine" id="cb166-6" data-line-number="6">ts &lt;-<span class="st"> </span>Boston[<span class="op">-</span>sp,]</a>
<a class="sourceLine" id="cb166-7" data-line-number="7">m &lt;-<span class="st"> </span><span class="kw">gbm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>tr, <span class="dt">n.trees=</span><span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb166-8" data-line-number="8">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts, <span class="dt">n.trees=</span><span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb166-9" data-line-number="9"><span class="kw">mean</span>(<span class="kw">abs</span>(ps<span class="op">-</span>ts<span class="op">$</span>medv))</a></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb167-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb167-3" data-line-number="3">rndSample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb167-4" data-line-number="4">tr &lt;-<span class="st"> </span>iris[rndSample, ]</a>
<a class="sourceLine" id="cb167-5" data-line-number="5">ts &lt;-<span class="st"> </span>iris[<span class="op">-</span>rndSample, ]</a>
<a class="sourceLine" id="cb167-6" data-line-number="6"></a>
<a class="sourceLine" id="cb167-7" data-line-number="7">m &lt;-<span class="st"> </span><span class="kw">gbm</span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>tr, <span class="dt">n.trees=</span><span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb167-8" data-line-number="8">         <span class="dt">cv.folds=</span><span class="dv">5</span>, <span class="dt">n.cores=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb167-9" data-line-number="9">(best &lt;-<span class="st"> </span><span class="kw">gbm.perf</span>(m, <span class="dt">plot.it=</span><span class="ot">FALSE</span>, <span class="dt">method=</span><span class="st">&quot;cv&quot;</span>))</a>
<a class="sourceLine" id="cb167-10" data-line-number="10">ps &lt;-<span class="st"> </span><span class="kw">predict</span>(m, ts, <span class="dt">n.trees=</span>best, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)[,,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb167-11" data-line-number="11">ps &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">colnames</span>(ps)[<span class="kw">max.col</span>(ps)])</a>
<a class="sourceLine" id="cb167-12" data-line-number="12">(cm &lt;-<span class="st"> </span><span class="kw">table</span>(ps, ts<span class="op">$</span>Species))</a>
<a class="sourceLine" id="cb167-13" data-line-number="13"><span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">diag</span>(cm))<span class="op">/</span><span class="kw">sum</span>(cm))  <span class="co"># the error rate</span></a></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw">summary</span>(m, <span class="dt">plotit=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="kw">plot</span>(m, <span class="dt">i.var=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb169-2" data-line-number="2"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>),</a>
<a class="sourceLine" id="cb169-3" data-line-number="3">       <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="kw">plot</span>(m, <span class="dt">i.var=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb170-2" data-line-number="2"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>),</a>
<a class="sourceLine" id="cb170-3" data-line-number="3">       <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<!-- evaluation.Rnw -->
</div>
</div>
<div id="evaluation" class="section level3">
<h3>Evaluation</h3>
<div id="the-holdout-and-random-subsampling" class="section level4">
<h4>The Holdout and Random Subsampling</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="kw">library</span>(performanceEstimation)</a>
<a class="sourceLine" id="cb171-2" data-line-number="2"><span class="kw">library</span>(e1071)</a>
<a class="sourceLine" id="cb171-3" data-line-number="3"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb171-4" data-line-number="4">r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(<span class="kw">PredTask</span>(Species <span class="op">~</span><span class="st"> </span>., iris),</a>
<a class="sourceLine" id="cb171-5" data-line-number="5">                           <span class="kw">Workflow</span>(<span class="dt">learner=</span><span class="st">&quot;svm&quot;</span>),</a>
<a class="sourceLine" id="cb171-6" data-line-number="6">                           <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;err&quot;</span>,<span class="dt">method=</span><span class="kw">Holdout</span>(<span class="dt">hldSz=</span><span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb171-7" data-line-number="7">                           )</a>
<a class="sourceLine" id="cb171-8" data-line-number="8"><span class="kw">summary</span>(r)</a></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="kw">library</span>(performanceEstimation)</a>
<a class="sourceLine" id="cb172-2" data-line-number="2"><span class="kw">library</span>(randomForest)</a>
<a class="sourceLine" id="cb172-3" data-line-number="3"><span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb172-4" data-line-number="4">r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(<span class="kw">PredTask</span>(medv <span class="op">~</span><span class="st"> </span>., Boston),</a>
<a class="sourceLine" id="cb172-5" data-line-number="5">                           <span class="kw">Workflow</span>(<span class="dt">learner=</span><span class="st">&quot;randomForest&quot;</span>),</a>
<a class="sourceLine" id="cb172-6" data-line-number="6">                           <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;mse&quot;</span>,</a>
<a class="sourceLine" id="cb172-7" data-line-number="7">                                          <span class="dt">method=</span><span class="kw">Holdout</span>(<span class="dt">nReps=</span><span class="dv">3</span>,<span class="dt">hldSz=</span><span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb172-8" data-line-number="8">                           )</a>
<a class="sourceLine" id="cb172-9" data-line-number="9"><span class="kw">summary</span>(r)</a></code></pre></div>
</div>
<div id="cross-validation" class="section level4">
<h4>Cross Validation</h4>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1"><span class="kw">library</span>(performanceEstimation)</a>
<a class="sourceLine" id="cb173-2" data-line-number="2"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb173-3" data-line-number="3"><span class="kw">data</span>(Boston, <span class="dt">package=</span><span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb173-4" data-line-number="4">r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(</a>
<a class="sourceLine" id="cb173-5" data-line-number="5">         <span class="kw">PredTask</span>(medv <span class="op">~</span><span class="st"> </span>., Boston),</a>
<a class="sourceLine" id="cb173-6" data-line-number="6">         <span class="kw">workflowVariants</span>(<span class="dt">learner=</span><span class="st">&quot;rpartXse&quot;</span>,</a>
<a class="sourceLine" id="cb173-7" data-line-number="7">                          <span class="dt">learner.pars=</span><span class="kw">list</span>(<span class="dt">se=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>))),</a>
<a class="sourceLine" id="cb173-8" data-line-number="8">         <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="kw">c</span>(<span class="st">&quot;mse&quot;</span>,<span class="st">&quot;mae&quot;</span>),</a>
<a class="sourceLine" id="cb173-9" data-line-number="9">                        <span class="dt">method=</span><span class="kw">CV</span>(<span class="dt">nReps=</span><span class="dv">3</span>,<span class="dt">nFolds=</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb173-10" data-line-number="10">     )</a>
<a class="sourceLine" id="cb173-11" data-line-number="11"><span class="kw">rankWorkflows</span>(r, <span class="dt">top=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="kw">getWorkflow</span>(<span class="st">&quot;rpartXse.v1&quot;</span>, r)</a></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="kw">plot</span>(r)</a></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="kw">plot</span>(r)</a></code></pre></div>
</div>
<div id="bootstrap-estimates" class="section level4">
<h4>Bootstrap Estimates</h4>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1"><span class="kw">library</span>(performanceEstimation)</a>
<a class="sourceLine" id="cb177-2" data-line-number="2"><span class="kw">library</span>(DMwR2)</a>
<a class="sourceLine" id="cb177-3" data-line-number="3"><span class="kw">library</span>(e1071)</a>
<a class="sourceLine" id="cb177-4" data-line-number="4"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb177-5" data-line-number="5"><span class="kw">data</span>(BreastCancer, <span class="dt">package=</span><span class="st">&quot;mlbench&quot;</span>)</a>
<a class="sourceLine" id="cb177-6" data-line-number="6">bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">knnImputation</span>(BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">11</span>)]), </a>
<a class="sourceLine" id="cb177-7" data-line-number="7">            <span class="dt">Class=</span>BreastCancer<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb177-8" data-line-number="8">r &lt;-<span class="st"> </span><span class="kw">performanceEstimation</span>(</a>
<a class="sourceLine" id="cb177-9" data-line-number="9">         <span class="kw">c</span>(<span class="kw">PredTask</span>(Species <span class="op">~</span><span class="st"> </span>., iris), </a>
<a class="sourceLine" id="cb177-10" data-line-number="10">           <span class="kw">PredTask</span>(Class <span class="op">~</span><span class="st"> </span>., bc)),</a>
<a class="sourceLine" id="cb177-11" data-line-number="11">         <span class="kw">workflowVariants</span>(<span class="dt">learner=</span><span class="st">&quot;svm&quot;</span>,</a>
<a class="sourceLine" id="cb177-12" data-line-number="12">                          <span class="dt">learner.pars=</span><span class="kw">list</span>(<span class="dt">cost=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb177-13" data-line-number="13">                                            <span class="dt">gamma=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.001</span>))),</a>
<a class="sourceLine" id="cb177-14" data-line-number="14">         <span class="kw">EstimationTask</span>(<span class="dt">metrics=</span><span class="st">&quot;acc&quot;</span>,</a>
<a class="sourceLine" id="cb177-15" data-line-number="15">                        <span class="dt">method=</span><span class="kw">Bootstrap</span>(<span class="dt">nReps=</span><span class="dv">200</span>,<span class="dt">type=</span><span class="st">&quot;.632&quot;</span>))</a>
<a class="sourceLine" id="cb177-16" data-line-number="16">    )</a></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="kw">topPerformers</span>(r , <span class="dt">maxs=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="recommended-procedures" class="section level4">
<h4>Recommended Procedures</h4>
<!-- DeployAndReport.Rnw -->
</div>
</div>
<div id="reporting-and-deployment" class="section level3">
<h3>Reporting and Deployment</h3>
<div id="reporting-through-dynamic-documents" class="section level4">
<h4>Reporting Through Dynamic Documents</h4>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1"><span class="kw">library</span>(rmarkdown)</a>
<a class="sourceLine" id="cb179-2" data-line-number="2"><span class="kw">render</span>(<span class="st">&quot;myreport.Rmd&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1"><span class="kw">render</span>(<span class="st">&quot;myreport.Rmd&quot;</span>, <span class="dt">output_format=</span><span class="st">&quot;word_document&quot;</span>)</a></code></pre></div>
</div>
<div id="deployment-through-web-applications" class="section level4">
<h4>Deployment Through Web Applications</h4>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb181-2" data-line-number="2"><span class="kw">runApp</span>(<span class="st">&quot;myAppFolderName&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb182-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb182-3" data-line-number="3"></a>
<a class="sourceLine" id="cb182-4" data-line-number="4"><span class="kw">shinyUI</span>(<span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb182-5" data-line-number="5">  <span class="kw">titlePanel</span>(<span class="st">&quot;Exploring the Iris dataset&quot;</span>),</a>
<a class="sourceLine" id="cb182-6" data-line-number="6">  <span class="kw">sidebarLayout</span>(</a>
<a class="sourceLine" id="cb182-7" data-line-number="7">      <span class="kw">sidebarPanel</span>(</a>
<a class="sourceLine" id="cb182-8" data-line-number="8">          <span class="kw">selectInput</span>(<span class="st">&quot;var&quot;</span>,</a>
<a class="sourceLine" id="cb182-9" data-line-number="9">                      <span class="st">&quot;Select a Predictor Variable:&quot;</span>,</a>
<a class="sourceLine" id="cb182-10" data-line-number="10">                      <span class="dt">choices=</span><span class="kw">colnames</span>(iris)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb182-11" data-line-number="11">      ),</a>
<a class="sourceLine" id="cb182-12" data-line-number="12">      <span class="kw">mainPanel</span>(</a>
<a class="sourceLine" id="cb182-13" data-line-number="13">          <span class="kw">plotOutput</span>(<span class="st">&quot;condBP&quot;</span>)</a>
<a class="sourceLine" id="cb182-14" data-line-number="14">      )</a>
<a class="sourceLine" id="cb182-15" data-line-number="15">  )</a>
<a class="sourceLine" id="cb182-16" data-line-number="16">))</a></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb183-2" data-line-number="2"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb183-3" data-line-number="3"></a>
<a class="sourceLine" id="cb183-4" data-line-number="4"><span class="kw">shinyServer</span>(</a>
<a class="sourceLine" id="cb183-5" data-line-number="5">    <span class="cf">function</span>(input, output) </a>
<a class="sourceLine" id="cb183-6" data-line-number="6">        {</a>
<a class="sourceLine" id="cb183-7" data-line-number="7">            output<span class="op">$</span>condBP &lt;-<span class="st"> </span><span class="kw">renderPlot</span>(</a>
<a class="sourceLine" id="cb183-8" data-line-number="8">                {</a>
<a class="sourceLine" id="cb183-9" data-line-number="9">                    form &lt;-<span class="st"> </span><span class="kw">as.formula</span>(<span class="kw">paste</span>(input<span class="op">$</span>var,<span class="st">&quot;~ Species&quot;</span>))</a>
<a class="sourceLine" id="cb183-10" data-line-number="10">                    <span class="kw">boxplot</span>(form,iris,<span class="dt">ylab=</span>input<span class="op">$</span>var,</a>
<a class="sourceLine" id="cb183-11" data-line-number="11">                            <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Distribution of&quot;</span>,input<span class="op">$</span>var,</a>
<a class="sourceLine" id="cb183-12" data-line-number="12">                                <span class="st">&quot;for the different Species&quot;</span>))</a>
<a class="sourceLine" id="cb183-13" data-line-number="13">                }</a>
<a class="sourceLine" id="cb183-14" data-line-number="14">            )  </a>
<a class="sourceLine" id="cb183-15" data-line-number="15">        }</a>
<a class="sourceLine" id="cb183-16" data-line-number="16">)</a></code></pre></div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
